<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Constructing the Real Numbers — From Algorithms to Continuum</title>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Source+Sans+Pro:wght@300;400;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --constructive-primary: #2D5A4A;
      --constructive-glow: #4A9D7C;
      --constructive-light: #E8F5F0;
      --classical-primary: #4A3C6D;
      --algorithm-accent: #E07B39;
      --undecidable-fog: #6B7280;
      --fog-light: #9CA3AF;
      --proof-valid: #059669;
      --proof-invalid: #DC2626;
      --sequence-color: #3B82F6;
      --limit-color: #EC4899;
      --epsilon-color: #F59E0B;
      --background: #FAF8F5;
      --background-dark: #0F0F12;
      --ink: #1A1A1A;
      --ink-light: #FAF8F5;
      
      --display: 'Crimson Text', serif;
      --body: 'Source Sans Pro', sans-serif;
      --mono: 'JetBrains Mono', monospace;
      
      --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--body);
      background: var(--background);
      color: var(--ink);
      line-height: 1.7;
      overflow-x: hidden;
    }

    /* ============================================
       OPENING
       ============================================ */
    
    .opening {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 2rem;
      background: linear-gradient(180deg, var(--constructive-primary) 0%, #1E3D31 100%);
      color: var(--ink-light);
      position: relative;
      overflow: hidden;
    }

    .opening::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 30% 40%, rgba(74, 157, 124, 0.2) 0%, transparent 50%),
        radial-gradient(circle at 70% 60%, rgba(59, 130, 246, 0.1) 0%, transparent 40%);
      pointer-events: none;
    }

    /* Floating rational numbers */
    .floating-rationals {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
      pointer-events: none;
    }

    .floating-rational {
      position: absolute;
      font-family: var(--mono);
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.15);
      animation: floatUp 15s linear infinite;
    }

    @keyframes floatUp {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
    }

    .opening-content {
      text-align: center;
      max-width: 800px;
      position: relative;
      z-index: 1;
    }

    .section-label {
      font-family: var(--mono);
      font-size: 0.7rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--constructive-glow);
      margin-bottom: 1rem;
      opacity: 0;
      animation: fadeUp 0.8s var(--ease-out-expo) 0.2s forwards;
    }

    .main-title {
      font-family: var(--display);
      font-size: clamp(2rem, 6vw, 3.5rem);
      font-weight: 400;
      line-height: 1.2;
      margin-bottom: 1.5rem;
      opacity: 0;
      animation: fadeUp 0.8s var(--ease-out-expo) 0.4s forwards;
    }

    .subtitle {
      font-size: 1.15rem;
      color: rgba(255, 255, 255, 0.85);
      max-width: 600px;
      margin: 0 auto;
      opacity: 0;
      animation: fadeUp 0.8s var(--ease-out-expo) 0.6s forwards;
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ============================================
       NARRATIVE SECTIONS
       ============================================ */

    .narrative-section {
      min-height: 60vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 4rem 2rem;
    }

    .narrative-section.dark {
      background: var(--background-dark);
      color: var(--ink-light);
    }

    .narrative-content {
      max-width: 650px;
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.8s var(--ease-out-expo), transform 0.8s var(--ease-out-expo);
    }

    .narrative-content.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .narrative-content p {
      font-size: 1.2rem;
      margin-bottom: 1.5rem;
    }

    .math-display {
      font-family: var(--mono);
      font-size: 1.1rem;
      background: var(--constructive-light);
      padding: 1.5rem;
      border-radius: 8px;
      text-align: center;
      margin: 1.5rem 0;
      border-left: 3px solid var(--constructive-primary);
    }

    .dark .math-display {
      background: rgba(74, 157, 124, 0.15);
    }

    .quote-block {
      border-left: 3px solid var(--constructive-glow);
      padding-left: 1.5rem;
      margin: 2rem 0;
      font-family: var(--display);
      font-style: italic;
      font-size: 1.25rem;
    }

    /* ============================================
       CAUCHY SEQUENCE VISUALIZER
       ============================================ */

    .cauchy-section {
      min-height: 100vh;
      padding: 4rem 2rem;
      background: linear-gradient(180deg, #F5F3F0 0%, var(--background) 100%);
    }

    .section-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .section-title {
      font-family: var(--display);
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .section-subtitle {
      color: #666;
      font-size: 1rem;
      max-width: 600px;
      margin: 0 auto;
    }

    .cauchy-container {
      max-width: 1000px;
      margin: 0 auto;
    }

    .sequence-selector {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    .seq-btn {
      padding: 0.7rem 1.2rem;
      border: 2px solid #E0E0E0;
      border-radius: 8px;
      background: white;
      font-family: var(--mono);
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .seq-btn:hover {
      border-color: var(--constructive-primary);
    }

    .seq-btn.active {
      border-color: var(--constructive-primary);
      background: var(--constructive-primary);
      color: white;
    }

    .visualizer-panel {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.08);
      overflow: hidden;
    }

    .visualizer-header {
      background: var(--constructive-primary);
      color: white;
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .sequence-name {
      font-family: var(--display);
      font-size: 1.2rem;
    }

    .sequence-formula {
      font-family: var(--mono);
      font-size: 0.85rem;
      opacity: 0.9;
    }

    .visualizer-body {
      padding: 2rem;
    }

    .number-line-container {
      position: relative;
      height: 200px;
      margin-bottom: 2rem;
    }

    #numberLineCanvas {
      width: 100%;
      height: 100%;
    }

    .controls-row {
      display: flex;
      gap: 2rem;
      align-items: start;
      flex-wrap: wrap;
    }

    .control-group {
      flex: 1;
      min-width: 200px;
    }

    .control-label {
      font-family: var(--mono);
      font-size: 0.7rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--undecidable-fog);
      margin-bottom: 0.5rem;
      display: block;
    }

    .epsilon-control {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .epsilon-slider {
      flex: 1;
      height: 8px;
      -webkit-appearance: none;
      background: #E0E0E0;
      border-radius: 4px;
      outline: none;
    }

    .epsilon-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      background: var(--epsilon-color);
      border-radius: 50%;
      cursor: pointer;
    }

    .epsilon-value {
      font-family: var(--mono);
      font-size: 1rem;
      color: var(--epsilon-color);
      min-width: 80px;
    }

    .modulus-display {
      background: var(--constructive-light);
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
    }

    .modulus-label {
      font-family: var(--mono);
      font-size: 0.75rem;
      color: var(--undecidable-fog);
      margin-bottom: 0.3rem;
    }

    .modulus-value {
      font-family: var(--mono);
      font-size: 1.5rem;
      color: var(--constructive-primary);
    }

    .modulus-explanation {
      font-size: 0.8rem;
      color: #666;
      margin-top: 0.5rem;
    }

    .terms-display {
      background: #FAFAFA;
      padding: 1rem;
      border-radius: 8px;
      margin-top: 1rem;
    }

    .terms-title {
      font-family: var(--mono);
      font-size: 0.7rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--undecidable-fog);
      margin-bottom: 0.5rem;
    }

    .terms-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .term-item {
      padding: 0.3rem 0.6rem;
      background: white;
      border: 1px solid #E0E0E0;
      border-radius: 4px;
      font-family: var(--mono);
      font-size: 0.75rem;
    }

    .term-item.in-range {
      border-color: var(--constructive-glow);
      background: rgba(74, 157, 124, 0.1);
      color: var(--constructive-primary);
    }

    /* ============================================
       MODULUS FUNCTION VISUALIZER
       ============================================ */

    .modulus-section {
      min-height: 100vh;
      padding: 4rem 2rem;
      background: var(--background-dark);
      color: var(--ink-light);
    }

    .modulus-container {
      max-width: 1000px;
      margin: 0 auto;
    }

    .modulus-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .modulus-title {
      font-family: var(--display);
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .modulus-subtitle {
      color: var(--fog-light);
      font-size: 1rem;
    }

    .modulus-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
    }

    @media (max-width: 800px) {
      .modulus-grid {
        grid-template-columns: 1fr;
      }
    }

    .modulus-chart-panel {
      background: rgba(30, 30, 40, 0.5);
      border: 1px solid rgba(107, 114, 128, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
    }

    .chart-title {
      font-family: var(--mono);
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--fog-light);
      margin-bottom: 1rem;
      text-align: center;
    }

    .chart-container {
      height: 250px;
      position: relative;
    }

    #modulusChart {
      width: 100%;
      height: 100%;
    }

    .algorithm-panel {
      background: rgba(30, 30, 40, 0.5);
      border: 1px solid rgba(107, 114, 128, 0.3);
      border-radius: 12px;
      padding: 1.5rem;
    }

    .algorithm-title {
      font-family: var(--mono);
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--fog-light);
      margin-bottom: 1rem;
    }

    .algorithm-code {
      background: #0A0A0F;
      padding: 1rem;
      border-radius: 8px;
      font-family: var(--mono);
      font-size: 0.8rem;
      line-height: 1.8;
      overflow-x: auto;
    }

    .code-keyword { color: var(--limit-color); }
    .code-function { color: var(--sequence-color); }
    .code-number { color: var(--epsilon-color); }
    .code-comment { color: var(--fog-light); }
    .code-var { color: var(--constructive-glow); }

    .key-insight {
      margin-top: 1.5rem;
      padding: 1rem;
      background: rgba(74, 157, 124, 0.15);
      border-left: 3px solid var(--constructive-glow);
      border-radius: 0 8px 8px 0;
    }

    .key-insight p {
      font-size: 0.9rem;
      color: var(--constructive-glow);
    }

    /* ============================================
       CRYSTALLIZATION ANIMATION
       ============================================ */

    .crystal-section {
      min-height: 100vh;
      padding: 4rem 2rem;
      background: linear-gradient(180deg, #0F0F12 0%, #1A1A20 100%);
      color: var(--ink-light);
    }

    .crystal-container {
      max-width: 800px;
      margin: 0 auto;
    }

    .crystal-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .crystal-title {
      font-family: var(--display);
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .crystal-subtitle {
      color: var(--fog-light);
      font-size: 1rem;
    }

    .crystal-display {
      background: rgba(30, 30, 40, 0.5);
      border: 1px solid rgba(107, 114, 128, 0.3);
      border-radius: 16px;
      padding: 2rem;
      text-align: center;
    }

    .decimal-display {
      font-family: var(--mono);
      font-size: 2.5rem;
      margin-bottom: 1.5rem;
      min-height: 60px;
    }

    .decimal-known {
      color: var(--constructive-glow);
    }

    .decimal-computing {
      color: var(--epsilon-color);
      animation: pulse 1s ease-in-out infinite;
    }

    .decimal-unknown {
      color: var(--fog-light);
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .crystal-controls {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .crystal-btn {
      padding: 0.7rem 1.5rem;
      border: 2px solid var(--constructive-glow);
      border-radius: 8px;
      background: transparent;
      color: var(--constructive-glow);
      font-family: var(--mono);
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .crystal-btn:hover {
      background: var(--constructive-glow);
      color: var(--background-dark);
    }

    .crystal-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .precision-indicator {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .precision-label {
      font-family: var(--mono);
      font-size: 0.75rem;
      color: var(--fog-light);
    }

    .precision-bar {
      width: 200px;
      height: 8px;
      background: rgba(107, 114, 128, 0.3);
      border-radius: 4px;
      overflow: hidden;
    }

    .precision-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--constructive-glow) 0%, var(--sequence-color) 100%);
      transition: width 0.5s var(--ease-out-expo);
    }

    .crystal-status {
      font-size: 0.9rem;
      color: var(--fog-light);
      min-height: 24px;
    }

    /* ============================================
       CLASSICAL VS CONSTRUCTIVE
       ============================================ */

    .comparison-section {
      padding: 4rem 2rem;
      background: var(--background);
    }

    .comparison-container {
      max-width: 900px;
      margin: 0 auto;
    }

    .comparison-header {
      text-align: center;
      margin-bottom: 3rem;
    }

    .comparison-title {
      font-family: var(--display);
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .comparison-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
    }

    @media (max-width: 700px) {
      .comparison-cards {
        grid-template-columns: 1fr;
      }
    }

    .comparison-card {
      padding: 2rem;
      border-radius: 12px;
    }

    .comparison-card.classical {
      background: rgba(74, 60, 109, 0.08);
      border: 2px solid var(--classical-primary);
    }

    .comparison-card.constructive {
      background: var(--constructive-light);
      border: 2px solid var(--constructive-primary);
    }

    .card-header {
      font-family: var(--mono);
      font-size: 0.7rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      margin-bottom: 1rem;
    }

    .classical .card-header { color: var(--classical-primary); }
    .constructive .card-header { color: var(--constructive-primary); }

    .card-title {
      font-family: var(--display);
      font-size: 1.3rem;
      margin-bottom: 1rem;
    }

    .card-content {
      font-size: 0.95rem;
      line-height: 1.7;
    }

    .card-content p {
      margin-bottom: 1rem;
    }

    .card-formula {
      font-family: var(--mono);
      font-size: 0.85rem;
      background: rgba(0, 0, 0, 0.05);
      padding: 0.8rem;
      border-radius: 6px;
      margin: 1rem 0;
    }

    .card-note {
      font-size: 0.85rem;
      padding: 0.8rem;
      border-radius: 6px;
      margin-top: 1rem;
    }

    .classical .card-note {
      background: rgba(74, 60, 109, 0.1);
      color: var(--classical-primary);
    }

    .constructive .card-note {
      background: rgba(45, 90, 74, 0.15);
      color: var(--constructive-primary);
    }

    /* ============================================
       BRIDGE TO CHAPTER 2
       ============================================ */

    .bridge-section {
      min-height: 60vh;
      padding: 4rem 2rem;
      background: linear-gradient(180deg, var(--constructive-primary) 0%, #1E3D31 100%);
      color: var(--ink-light);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .bridge-content {
      max-width: 700px;
      text-align: center;
    }

    .bridge-label {
      font-family: var(--mono);
      font-size: 0.7rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: var(--constructive-glow);
      margin-bottom: 1.5rem;
    }

    .bridge-text {
      font-family: var(--display);
      font-size: clamp(1.3rem, 3.5vw, 1.8rem);
      font-style: italic;
      line-height: 1.6;
      margin-bottom: 2rem;
    }

    .bridge-chapters {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
    }

    .chapter-link {
      padding: 1rem 2rem;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      text-align: center;
    }

    .chapter-number {
      font-family: var(--mono);
      font-size: 0.7rem;
      color: var(--constructive-glow);
      margin-bottom: 0.3rem;
    }

    .chapter-name {
      font-family: var(--display);
      font-size: 1.1rem;
    }
  </style>
</head>
<body>

  <!-- Opening -->
  <section class="opening">
    <div class="floating-rationals">
      <span class="floating-rational" style="left: 10%; animation-delay: 0s;">3/2</span>
      <span class="floating-rational" style="left: 25%; animation-delay: 2s;">7/5</span>
      <span class="floating-rational" style="left: 40%; animation-delay: 4s;">17/12</span>
      <span class="floating-rational" style="left: 55%; animation-delay: 6s;">41/29</span>
      <span class="floating-rational" style="left: 70%; animation-delay: 8s;">99/70</span>
      <span class="floating-rational" style="left: 85%; animation-delay: 10s;">239/169</span>
    </div>
    
    <div class="opening-content">
      <p class="section-label">From Rationals to Reals</p>
      <h1 class="main-title">Constructing the Continuum</h1>
      <p class="subtitle">A real number is not a point on a line—it's an algorithm that produces rational approximations to any desired precision.</p>
    </div>
  </section>

  <!-- Narrative: The Problem -->
  <section class="narrative-section">
    <div class="narrative-content" data-animate>
      <p>The rational numbers are not enough. There is no fraction whose square equals 2. The diagonal of a unit square has a length that escapes the rationals.</p>
      <p>Classical mathematics solves this by <em>completing</em> the rationals—filling in the "gaps" to create the real numbers. But constructively, we must ask: <em>what does it mean to construct a real number?</em></p>
    </div>
  </section>

  <!-- Narrative: The Answer -->
  <section class="narrative-section">
    <div class="narrative-content" data-animate>
      <p>Bishop's answer: a real number is a <strong>Cauchy sequence of rationals</strong> together with a <strong>computable modulus of convergence</strong>.</p>
      <div class="math-display">
        A real number x is a sequence (xₙ) of rationals plus<br>
        a function ω: ℚ⁺ → ℕ such that<br>
        |xₘ - xₙ| < ε whenever m, n ≥ ω(ε)
      </div>
      <p>The modulus ω tells us <em>how fast</em> the sequence converges. It must be computable—we need an algorithm to calculate ω(ε) for any ε.</p>
    </div>
  </section>

  <!-- Cauchy Sequence Visualizer -->
  <section class="cauchy-section">
    <div class="section-header">
      <h2 class="section-title">Watch a Real Number Form</h2>
      <p class="section-subtitle">Select a sequence, adjust the precision ε, and see the modulus respond</p>
    </div>

    <div class="cauchy-container">
      <div class="sequence-selector">
        <button class="seq-btn active" data-sequence="sqrt2">√2</button>
        <button class="seq-btn" data-sequence="pi">π</button>
        <button class="seq-btn" data-sequence="e">e</button>
        <button class="seq-btn" data-sequence="golden">φ (golden ratio)</button>
      </div>

      <div class="visualizer-panel">
        <div class="visualizer-header">
          <span class="sequence-name" id="seqName">√2 via Newton's Method</span>
          <span class="sequence-formula" id="seqFormula">xₙ₊₁ = (xₙ + 2/xₙ) / 2</span>
        </div>

        <div class="visualizer-body">
          <div class="number-line-container">
            <canvas id="numberLineCanvas"></canvas>
          </div>

          <div class="controls-row">
            <div class="control-group">
              <label class="control-label">Precision (ε)</label>
              <div class="epsilon-control">
                <input type="range" class="epsilon-slider" id="epsilonSlider" 
                       min="-4" max="0" step="0.1" value="-1">
                <span class="epsilon-value" id="epsilonValue">ε = 0.1</span>
              </div>
            </div>

            <div class="control-group">
              <label class="control-label">Modulus of Convergence</label>
              <div class="modulus-display">
                <p class="modulus-label">ω(ε) =</p>
                <p class="modulus-value" id="modulusValue">N = 4</p>
                <p class="modulus-explanation" id="modulusExplanation">
                  All terms after x₄ are within ε of the limit
                </p>
              </div>
            </div>
          </div>

          <div class="terms-display">
            <p class="terms-title">First 12 Terms</p>
            <div class="terms-list" id="termsList">
              <!-- Generated by JavaScript -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Modulus Function Visualizer -->
  <section class="modulus-section">
    <div class="modulus-container">
      <div class="modulus-header">
        <h2 class="modulus-title">The Modulus is the Algorithm</h2>
        <p class="modulus-subtitle">For each ε, the modulus computes how many terms we need</p>
      </div>

      <div class="modulus-grid">
        <div class="modulus-chart-panel">
          <p class="chart-title">ω(ε) for √2 (Newton's Method)</p>
          <div class="chart-container">
            <canvas id="modulusChart"></canvas>
          </div>
        </div>

        <div class="algorithm-panel">
          <p class="algorithm-title">The Modulus Algorithm</p>
          <div class="algorithm-code">
<span class="code-keyword">function</span> <span class="code-function">modulus_sqrt2</span>(<span class="code-var">ε</span>) {
  <span class="code-comment">// Newton's method doubles precision each step</span>
  <span class="code-comment">// Error after n steps: ≤ 2^(-2^n)</span>
  
  <span class="code-keyword">let</span> <span class="code-var">n</span> = <span class="code-number">1</span>;
  <span class="code-keyword">while</span> (Math.pow(<span class="code-number">2</span>, -Math.pow(<span class="code-number">2</span>, <span class="code-var">n</span>)) > <span class="code-var">ε</span>) {
    <span class="code-var">n</span>++;
  }
  <span class="code-keyword">return</span> <span class="code-var">n</span>;
}

<span class="code-comment">// Example outputs:</span>
<span class="code-function">modulus_sqrt2</span>(<span class="code-number">0.1</span>)   <span class="code-comment">// → 2</span>
<span class="code-function">modulus_sqrt2</span>(<span class="code-number">0.01</span>)  <span class="code-comment">// → 3</span>
<span class="code-function">modulus_sqrt2</span>(<span class="code-number">0.001</span>) <span class="code-comment">// → 4</span>
          </div>

          <div class="key-insight">
            <p><strong>Key insight:</strong> This algorithm is <em>computable</em>. Given any ε, we can calculate ω(ε) in finite time. This is what makes √2 a constructive real number.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Crystallization Animation -->
  <section class="crystal-section">
    <div class="crystal-container">
      <div class="crystal-header">
        <h2 class="crystal-title">Crystallization</h2>
        <p class="crystal-subtitle">Watch the decimal expansion emerge digit by digit</p>
      </div>

      <div class="crystal-display">
        <div class="decimal-display" id="decimalDisplay">
          <span class="decimal-known">1.</span><span class="decimal-computing">_</span><span class="decimal-unknown">__________</span>
        </div>

        <div class="precision-indicator">
          <span class="precision-label">Precision:</span>
          <div class="precision-bar">
            <div class="precision-fill" id="precisionFill" style="width: 5%;"></div>
          </div>
          <span class="precision-label" id="precisionDigits">1 digit</span>
        </div>

        <div class="crystal-controls">
          <button class="crystal-btn" id="computeMore">Compute More Digits</button>
          <button class="crystal-btn" id="resetCrystal">Reset</button>
        </div>

        <p class="crystal-status" id="crystalStatus">
          Click "Compute More Digits" to reveal the next decimal place
        </p>
      </div>
    </div>
  </section>

  <!-- Classical vs Constructive -->
  <section class="comparison-section">
    <div class="comparison-container">
      <div class="comparison-header">
        <h2 class="comparison-title">Two Views of the Reals</h2>
      </div>

      <div class="comparison-cards">
        <div class="comparison-card classical">
          <p class="card-header">Classical</p>
          <h3 class="card-title">Dedekind Cuts</h3>
          <div class="card-content">
            <p>A real number is a "cut" in the rationals—a division of ℚ into two sets L and R where every element of L is less than every element of R.</p>
            <div class="card-formula">
              √2 = { q ∈ ℚ : q < 0 ∨ q² < 2 } | { q ∈ ℚ : q > 0 ∧ q² > 2 }
            </div>
            <p>This defines √2 by a <em>property</em>, not a construction. The number exists because the cut exists.</p>
          </div>
          <div class="card-note">
            No algorithm needed. Existence is guaranteed by logic.
          </div>
        </div>

        <div class="comparison-card constructive">
          <p class="card-header">Constructive</p>
          <h3 class="card-title">Cauchy + Modulus</h3>
          <div class="card-content">
            <p>A real number is an algorithm that produces rational approximations. The modulus tells us how fast they converge.</p>
            <div class="card-formula">
              √2: xₙ₊₁ = (xₙ + 2/xₙ)/2, x₁ = 1<br>
              ω(ε) = ⌈log₂(log₂(1/ε))⌉
            </div>
            <p>This defines √2 by a <em>procedure</em>. The number exists because we can compute it.</p>
          </div>
          <div class="card-note">
            The modulus must be computable. Existence means computability.
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Narrative: Non-constructive example -->
  <section class="narrative-section dark">
    <div class="narrative-content" data-animate>
      <p>Not every classically-defined sequence has a computable modulus. Consider:</p>
      <div class="math-display" style="background: rgba(220, 38, 38, 0.15); border-color: var(--proof-invalid);">
        xₙ = 1/n if the Riemann Hypothesis is true<br>
        xₙ = 0 if the Riemann Hypothesis is false
      </div>
      <p>This sequence converges to <em>some</em> limit classically. But constructively, we cannot compute its modulus without first resolving the Riemann Hypothesis!</p>
      <p>The modulus requirement filters out "fake" real numbers—sequences that converge only because of logical fiat, not algorithmic content.</p>
    </div>
  </section>

  <!-- Bridge to Chapter 2 -->
  <section class="bridge-section">
    <div class="bridge-content" data-animate>
      <p class="bridge-label">End of Chapter 1</p>
      <p class="bridge-text">
        With real numbers defined as algorithms, we have laid the foundation. The manifesto is complete. Now the real work begins: building analysis—limits, continuity, differentiation, integration—on constructive foundations.
      </p>
      <div class="bridge-chapters">
        <div class="chapter-link">
          <p class="chapter-number">Chapter 2</p>
          <p class="chapter-name">Calculus and the Real Numbers</p>
        </div>
        <div class="chapter-link">
          <p class="chapter-number">Chapter 3</p>
          <p class="chapter-name">Set Theory</p>
        </div>
        <div class="chapter-link">
          <p class="chapter-number">Chapter 4</p>
          <p class="chapter-name">Metric Spaces</p>
        </div>
      </div>
    </div>
  </section>

  <script>
    // ============================================
    // SCROLL ANIMATIONS
    // ============================================
    
    const observerOptions = { threshold: 0.3, rootMargin: '0px 0px -10% 0px' };
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('visible');
      });
    }, observerOptions);

    document.querySelectorAll('[data-animate], .narrative-content').forEach(el => observer.observe(el));

    // ============================================
    // SEQUENCE DEFINITIONS
    // ============================================
    
    const sequences = {
      sqrt2: {
        name: '√2 via Newton\'s Method',
        formula: 'xₙ₊₁ = (xₙ + 2/xₙ) / 2',
        limit: Math.sqrt(2),
        generate: (n) => {
          let x = 1;
          for (let i = 0; i < n; i++) {
            x = (x + 2/x) / 2;
          }
          return x;
        },
        modulus: (eps) => {
          // Newton's method: error ≤ 2^(-2^n) after n steps
          let n = 1;
          while (Math.pow(2, -Math.pow(2, n)) > eps) {
            n++;
            if (n > 10) break;
          }
          return n;
        }
      },
      pi: {
        name: 'π via Leibniz Series',
        formula: 'π/4 = 1 - 1/3 + 1/5 - 1/7 + ...',
        limit: Math.PI,
        generate: (n) => {
          let sum = 0;
          for (let k = 0; k < n * 100; k++) {
            sum += Math.pow(-1, k) / (2*k + 1);
          }
          return sum * 4;
        },
        modulus: (eps) => {
          // Leibniz: error ≈ 1/(2n+1), need n > 1/(4ε)
          return Math.ceil(1 / (4 * eps));
        }
      },
      e: {
        name: 'e via Factorial Series',
        formula: 'e = Σ 1/n!',
        limit: Math.E,
        generate: (n) => {
          let sum = 0;
          let factorial = 1;
          for (let k = 0; k <= n + 5; k++) {
            if (k > 0) factorial *= k;
            sum += 1 / factorial;
          }
          return sum;
        },
        modulus: (eps) => {
          // Factorial series: error < 1/n! after n terms
          let n = 1, factorial = 1;
          while (1/factorial > eps) {
            n++;
            factorial *= n;
            if (n > 20) break;
          }
          return n;
        }
      },
      golden: {
        name: 'φ via Fibonacci Ratios',
        formula: 'φ = lim Fₙ₊₁/Fₙ',
        limit: (1 + Math.sqrt(5)) / 2,
        generate: (n) => {
          let a = 1, b = 1;
          for (let i = 0; i < n + 2; i++) {
            [a, b] = [b, a + b];
          }
          return b / a;
        },
        modulus: (eps) => {
          // Fibonacci: error ≈ 1/φ^(2n)
          const phi = (1 + Math.sqrt(5)) / 2;
          return Math.ceil(Math.log(1/eps) / (2 * Math.log(phi)));
        }
      }
    };

    let currentSequence = 'sqrt2';
    let currentEpsilon = 0.1;

    // ============================================
    // CANVAS UTILITIES
    // ============================================
    
    function setupCanvas(canvas) {
      const dpr = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      const ctx = canvas.getContext('2d');
      ctx.scale(dpr, dpr);
      return { ctx, width: rect.width, height: rect.height };
    }

    // ============================================
    // NUMBER LINE VISUALIZATION
    // ============================================
    
    const numberLineCanvas = document.getElementById('numberLineCanvas');

    function drawNumberLine() {
      const { ctx, width, height } = setupCanvas(numberLineCanvas);
      const seq = sequences[currentSequence];
      const limit = seq.limit;
      const N = seq.modulus(currentEpsilon);

      // Calculate view bounds
      const terms = [];
      for (let i = 1; i <= 12; i++) {
        terms.push(seq.generate(i));
      }
      
      const allVals = [...terms, limit];
      const minVal = Math.min(...allVals) - 0.1;
      const maxVal = Math.max(...allVals) + 0.1;

      const padding = 50;
      const plotWidth = width - 2 * padding;

      // Clear
      ctx.fillStyle = 'white';
      ctx.fillRect(0, 0, width, height);

      // Draw epsilon band around limit
      const limitX = padding + ((limit - minVal) / (maxVal - minVal)) * plotWidth;
      const epsWidth = (currentEpsilon / (maxVal - minVal)) * plotWidth;
      
      ctx.fillStyle = 'rgba(245, 158, 11, 0.15)';
      ctx.fillRect(limitX - epsWidth, 40, epsWidth * 2, height - 80);

      // Epsilon band borders
      ctx.strokeStyle = 'rgba(245, 158, 11, 0.5)';
      ctx.setLineDash([5, 5]);
      ctx.beginPath();
      ctx.moveTo(limitX - epsWidth, 40);
      ctx.lineTo(limitX - epsWidth, height - 40);
      ctx.moveTo(limitX + epsWidth, 40);
      ctx.lineTo(limitX + epsWidth, height - 40);
      ctx.stroke();
      ctx.setLineDash([]);

      // Draw number line
      const lineY = height / 2;
      ctx.strokeStyle = '#CCC';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(padding, lineY);
      ctx.lineTo(width - padding, lineY);
      ctx.stroke();

      // Draw limit point
      ctx.fillStyle = '#EC4899';
      ctx.beginPath();
      ctx.arc(limitX, lineY, 10, 0, Math.PI * 2);
      ctx.fill();

      // Label
      ctx.fillStyle = '#EC4899';
      ctx.font = '12px "JetBrains Mono"';
      ctx.textAlign = 'center';
      ctx.fillText(limit.toFixed(6), limitX, lineY + 30);
      ctx.fillText('limit', limitX, lineY + 45);

      // Draw sequence terms
      terms.forEach((val, i) => {
        const x = padding + ((val - minVal) / (maxVal - minVal)) * plotWidth;
        const y = lineY - 20 - (i % 3) * 15;
        
        const inRange = (i + 1) >= N;
        
        ctx.fillStyle = inRange ? '#059669' : '#3B82F6';
        ctx.beginPath();
        ctx.arc(x, y, 6, 0, Math.PI * 2);
        ctx.fill();

        // Connector to line
        ctx.strokeStyle = inRange ? 'rgba(5, 150, 105, 0.3)' : 'rgba(59, 130, 246, 0.3)';
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(x, y + 6);
        ctx.lineTo(x, lineY - 5);
        ctx.stroke();

        // Label
        ctx.fillStyle = inRange ? '#059669' : '#3B82F6';
        ctx.font = '9px "JetBrains Mono"';
        ctx.textAlign = 'center';
        ctx.fillText(`x${i + 1}`, x, y - 10);
      });

      // Labels
      ctx.fillStyle = '#F59E0B';
      ctx.font = '11px "JetBrains Mono"';
      ctx.textAlign = 'center';
      ctx.fillText('−ε', limitX - epsWidth, 30);
      ctx.fillText('+ε', limitX + epsWidth, 30);

      // Update terms list
      updateTermsList(terms, N);
    }

    function updateTermsList(terms, N) {
      const termsList = document.getElementById('termsList');
      termsList.innerHTML = '';
      
      terms.forEach((val, i) => {
        const item = document.createElement('span');
        item.className = 'term-item' + ((i + 1) >= N ? ' in-range' : '');
        item.textContent = `x${i + 1} = ${val.toFixed(6)}`;
        termsList.appendChild(item);
      });
    }

    // ============================================
    // MODULUS CHART
    // ============================================
    
    const modulusChart = document.getElementById('modulusChart');

    function drawModulusChart() {
      const { ctx, width, height } = setupCanvas(modulusChart);
      const seq = sequences[currentSequence];

      ctx.fillStyle = '#12121A';
      ctx.fillRect(0, 0, width, height);

      const padding = 40;
      const plotWidth = width - 2 * padding;
      const plotHeight = height - 2 * padding;

      // Grid
      ctx.strokeStyle = 'rgba(107, 114, 128, 0.2)';
      ctx.lineWidth = 1;
      for (let i = 0; i <= 5; i++) {
        const x = padding + (i / 5) * plotWidth;
        ctx.beginPath();
        ctx.moveTo(x, padding);
        ctx.lineTo(x, height - padding);
        ctx.stroke();
      }
      for (let i = 0; i <= 4; i++) {
        const y = padding + (i / 4) * plotHeight;
        ctx.beginPath();
        ctx.moveTo(padding, y);
        ctx.lineTo(width - padding, y);
        ctx.stroke();
      }

      // Axes labels
      ctx.fillStyle = '#9CA3AF';
      ctx.font = '10px "JetBrains Mono"';
      ctx.textAlign = 'center';
      ctx.fillText('ε', width - padding + 15, height - padding + 4);
      ctx.fillText('0.0001', padding, height - padding + 15);
      ctx.fillText('1', width - padding, height - padding + 15);

      ctx.textAlign = 'right';
      ctx.fillText('N', padding - 8, padding);

      // Draw modulus curve
      const epsilonValues = [];
      const modulusValues = [];
      
      for (let i = 0; i <= 50; i++) {
        const t = i / 50;
        const eps = Math.pow(10, -4 + t * 4); // 0.0001 to 1
        epsilonValues.push(eps);
        modulusValues.push(seq.modulus(eps));
      }

      const maxN = Math.max(...modulusValues);

      ctx.strokeStyle = '#4A9D7C';
      ctx.lineWidth = 3;
      ctx.beginPath();

      epsilonValues.forEach((eps, i) => {
        const x = padding + (Math.log10(eps) + 4) / 4 * plotWidth;
        const y = height - padding - (modulusValues[i] / maxN) * plotHeight;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.stroke();

      // Mark current epsilon
      const currentX = padding + (Math.log10(currentEpsilon) + 4) / 4 * plotWidth;
      const currentN = seq.modulus(currentEpsilon);
      const currentY = height - padding - (currentN / maxN) * plotHeight;

      ctx.fillStyle = '#F59E0B';
      ctx.beginPath();
      ctx.arc(currentX, currentY, 8, 0, Math.PI * 2);
      ctx.fill();

      // Dotted lines to axes
      ctx.strokeStyle = 'rgba(245, 158, 11, 0.5)';
      ctx.setLineDash([5, 5]);
      ctx.beginPath();
      ctx.moveTo(currentX, currentY);
      ctx.lineTo(currentX, height - padding);
      ctx.moveTo(currentX, currentY);
      ctx.lineTo(padding, currentY);
      ctx.stroke();
      ctx.setLineDash([]);
    }

    // ============================================
    // CONTROLS
    // ============================================
    
    const epsilonSlider = document.getElementById('epsilonSlider');
    const epsilonValue = document.getElementById('epsilonValue');
    const modulusValue = document.getElementById('modulusValue');
    const modulusExplanation = document.getElementById('modulusExplanation');
    const seqName = document.getElementById('seqName');
    const seqFormula = document.getElementById('seqFormula');

    epsilonSlider.addEventListener('input', () => {
      currentEpsilon = Math.pow(10, parseFloat(epsilonSlider.value));
      updateDisplays();
      drawNumberLine();
      drawModulusChart();
    });

    document.querySelectorAll('.seq-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.seq-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentSequence = btn.dataset.sequence;
        
        const seq = sequences[currentSequence];
        seqName.textContent = seq.name;
        seqFormula.textContent = seq.formula;
        
        updateDisplays();
        drawNumberLine();
        drawModulusChart();
      });
    });

    function updateDisplays() {
      const seq = sequences[currentSequence];
      const N = seq.modulus(currentEpsilon);
      
      epsilonValue.textContent = `ε = ${currentEpsilon.toFixed(4)}`;
      modulusValue.textContent = `N = ${N}`;
      modulusExplanation.textContent = `All terms after x${N} are within ε of the limit`;
    }

    // ============================================
    // CRYSTALLIZATION
    // ============================================
    
    const decimalDisplay = document.getElementById('decimalDisplay');
    const precisionFill = document.getElementById('precisionFill');
    const precisionDigits = document.getElementById('precisionDigits');
    const crystalStatus = document.getElementById('crystalStatus');
    const computeMoreBtn = document.getElementById('computeMore');
    const resetCrystalBtn = document.getElementById('resetCrystal');

    let crystalDigits = 1;
    const maxCrystalDigits = 15;
    const targetValue = Math.sqrt(2);

    function updateCrystalDisplay() {
      const known = targetValue.toFixed(crystalDigits);
      const computing = crystalDigits < maxCrystalDigits ? '_' : '';
      const unknown = crystalDigits < maxCrystalDigits ? 
        '_'.repeat(Math.max(0, 10 - crystalDigits)) : '';
      
      decimalDisplay.innerHTML = 
        `<span class="decimal-known">${known}</span>` +
        `<span class="decimal-computing">${computing}</span>` +
        `<span class="decimal-unknown">${unknown}</span>`;
      
      precisionFill.style.width = `${(crystalDigits / maxCrystalDigits) * 100}%`;
      precisionDigits.textContent = `${crystalDigits} digit${crystalDigits > 1 ? 's' : ''}`;
      
      if (crystalDigits >= maxCrystalDigits) {
        crystalStatus.textContent = 'Maximum precision reached for this display';
        computeMoreBtn.disabled = true;
      } else {
        const eps = Math.pow(10, -crystalDigits);
        const N = sequences.sqrt2.modulus(eps);
        crystalStatus.textContent = `Computing x${N} to get ${crystalDigits + 1} digits of precision...`;
      }
    }

    computeMoreBtn.addEventListener('click', () => {
      if (crystalDigits < maxCrystalDigits) {
        crystalDigits++;
        updateCrystalDisplay();
      }
    });

    resetCrystalBtn.addEventListener('click', () => {
      crystalDigits = 1;
      computeMoreBtn.disabled = false;
      updateCrystalDisplay();
    });

    // ============================================
    // INITIALIZE
    // ============================================
    
    updateDisplays();
    drawNumberLine();
    drawModulusChart();
    updateCrystalDisplay();

    window.addEventListener('resize', () => {
      drawNumberLine();
      drawModulusChart();
    });
  </script>
</body>
</html>
