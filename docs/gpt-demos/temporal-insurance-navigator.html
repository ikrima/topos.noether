<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Temporal Insurance Navigator - Brazos Built Right</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: #000;
            color: #fff;
            overflow-x: hidden;
            position: relative;
        }

        /* Time-based gradient background */
        .temporal-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                #000 0%, 
                #001a33 25%, 
                #002952 50%, 
                #003d7a 75%, 
                #0051a3 100%);
            opacity: 0.3;
            z-index: -2;
        }

        /* Animated time particles */
        .time-particles {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            animation: float 20s infinite linear;
        }

        @keyframes float {
            from {
                transform: translateX(-100px) translateY(100vh);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            to {
                transform: translateX(calc(100vw + 100px)) translateY(-100vh);
                opacity: 0;
            }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px;
            position: relative;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 60px;
            padding-top: 40px;
        }

        .header h1 {
            font-size: 56px;
            font-weight: 700;
            letter-spacing: -3px;
            margin-bottom: 16px;
            background: linear-gradient(90deg, #007AFF 0%, #AF52DE 50%, #34C759 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientSlide 8s ease infinite;
        }

        @keyframes gradientSlide {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .header p {
            font-size: 20px;
            color: #8e8e93;
        }

        /* Time Controller */
        .time-controller {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 40px;
            backdrop-filter: blur(20px);
        }

        .year-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .current-year {
            font-size: 72px;
            font-weight: 800;
            letter-spacing: -3px;
            background: linear-gradient(135deg, #fff, #8e8e93);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .year-context {
            font-size: 18px;
            color: #8e8e93;
            margin-top: 8px;
        }

        .timeline-slider {
            width: 100%;
            height: 60px;
            position: relative;
            margin: 40px 0;
            cursor: pointer;
        }

        .timeline-track {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                #007AFF 0%, 
                #AF52DE 50%, 
                #34C759 100%);
            transform: translateY(-50%);
            border-radius: 2px;
        }

        .timeline-markers {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 10px;
        }

        .marker {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .marker-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #1c1c1e;
            border: 3px solid #007AFF;
            margin-bottom: 8px;
            transition: all 0.3s ease;
            position: relative;
        }

        .marker.active .marker-dot {
            width: 24px;
            height: 24px;
            background: #007AFF;
            box-shadow: 0 0 20px rgba(0, 122, 255, 0.8);
        }

        .marker.milestone .marker-dot {
            border-color: #FF9500;
        }

        .marker-label {
            font-size: 12px;
            color: #8e8e93;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .marker:hover .marker-label,
        .marker.active .marker-label {
            opacity: 1;
        }

        .timeline-handle {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #007AFF, #0051D5);
            box-shadow: 0 4px 20px rgba(0, 122, 255, 0.5);
            cursor: grab;
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 14px;
        }

        .timeline-handle:active {
            cursor: grabbing;
            transform: translate(-50%, -50%) scale(1.2);
        }

        /* Metrics Dashboard */
        .metrics-dashboard {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
            margin-bottom: 40px;
        }

        .metric-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 24px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--metric-color);
            transition: height 0.3s ease;
        }

        .metric-card:hover::before {
            height: 100%;
            opacity: 0.1;
        }

        .metric-icon {
            font-size: 28px;
            margin-bottom: 12px;
        }

        .metric-label {
            font-size: 12px;
            color: #8e8e93;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--metric-color);
            transition: all 0.5s ease;
        }

        .metric-delta {
            font-size: 14px;
            color: #8e8e93;
            margin-top: 8px;
        }

        /* Business Evolution Visual */
        .evolution-container {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 40px;
            position: relative;
            height: 400px;
        }

        .evolution-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
        }

        .evolution-canvas {
            position: relative;
            width: 100%;
            height: 300px;
        }

        .evolution-stage {
            position: absolute;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border: 2px solid;
            border-radius: 16px;
            transition: all 0.5s ease;
            cursor: pointer;
        }

        .stage-1 {
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            border-color: #007AFF;
        }

        .stage-2 {
            left: 25%;
            top: 30%;
            transform: translate(-50%, -50%);
            border-color: #AF52DE;
        }

        .stage-3 {
            left: 50%;
            top: 20%;
            transform: translate(-50%, -50%);
            border-color: #FF9500;
        }

        .stage-4 {
            left: 75%;
            top: 15%;
            transform: translate(-50%, -50%);
            border-color: #34C759;
        }

        .stage-5 {
            right: 0;
            top: 10%;
            transform: translateY(-50%);
            border-color: #FF3B30;
        }

        .evolution-stage.active {
            background: rgba(255,255,255,0.1);
            transform: scale(1.1) translateY(-50%);
            box-shadow: 0 10px 40px rgba(0, 122, 255, 0.3);
        }

        .stage-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .stage-details {
            font-size: 14px;
            color: #8e8e93;
        }

        /* Risk Timeline */
        .risk-timeline {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 40px;
        }

        .risk-chart {
            position: relative;
            height: 200px;
            margin-top: 30px;
        }

        .risk-line {
            stroke-width: 3;
            fill: none;
            filter: drop-shadow(0 0 10px rgba(255, 59, 48, 0.5));
        }

        .coverage-line {
            stroke-width: 3;
            fill: none;
            filter: drop-shadow(0 0 10px rgba(52, 199, 89, 0.5));
        }

        /* Milestone Events */
        .milestones-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-bottom: 40px;
        }

        .milestone-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02));
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .milestone-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--milestone-color) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .milestone-card:hover::before {
            opacity: 0.1;
        }

        .milestone-card:hover {
            transform: translateY(-4px);
            border-color: var(--milestone-color);
        }

        .milestone-year {
            font-size: 14px;
            color: var(--milestone-color);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .milestone-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .milestone-description {
            font-size: 14px;
            color: #8e8e93;
            line-height: 1.5;
        }

        /* Decision Points */
        .decision-panel {
            background: linear-gradient(135deg, rgba(0,122,255,0.1), rgba(175,82,222,0.1));
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 40px;
        }

        .decision-title {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .decisions-list {
            display: grid;
            gap: 16px;
        }

        .decision-item {
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .decision-item:hover {
            background: rgba(0,0,0,0.5);
            transform: translateX(8px);
        }

        .decision-icon {
            font-size: 24px;
            min-width: 30px;
        }

        .decision-content {
            flex: 1;
        }

        .decision-text {
            font-size: 16px;
            margin-bottom: 4px;
        }

        .decision-impact {
            font-size: 14px;
            color: #8e8e93;
        }

        .decision-action {
            padding: 8px 16px;
            background: rgba(0,122,255,0.2);
            border: 1px solid #007AFF;
            border-radius: 8px;
            font-size: 14px;
            color: #007AFF;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .decision-action:hover {
            background: rgba(0,122,255,0.3);
            transform: scale(1.05);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .metrics-dashboard {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .metrics-dashboard {
                grid-template-columns: 1fr;
            }
            .milestones-grid {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 36px;
            }
        }
    </style>
</head>
<body>
    <div class="temporal-bg"></div>
    <div class="time-particles" id="particles"></div>
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>Temporal Insurance Navigator</h1>
            <p>Drag through time to see how your insurance needs evolve with your business</p>
        </header>

        <!-- Time Controller -->
        <div class="time-controller">
            <div class="year-display">
                <div class="current-year" id="current-year">2025</div>
                <div class="year-context" id="year-context">Starting Point - $750K Revenue</div>
            </div>
            
            <div class="timeline-slider" id="timeline-slider">
                <div class="timeline-track"></div>
                <div class="timeline-markers" id="timeline-markers">
                    <!-- Dynamically generated markers -->
                </div>
                <div class="timeline-handle" id="timeline-handle" style="left: 0%">
                    <span id="handle-year">Y0</span>
                </div>
            </div>
        </div>

        <!-- Metrics Dashboard -->
        <div class="metrics-dashboard">
            <div class="metric-card" style="--metric-color: #007AFF">
                <div class="metric-icon">üí∞</div>
                <div class="metric-label">Annual Revenue</div>
                <div class="metric-value" id="revenue-metric">$750K</div>
                <div class="metric-delta" id="revenue-delta">Base year</div>
            </div>
            
            <div class="metric-card" style="--metric-color: #34C759">
                <div class="metric-icon">üõ°Ô∏è</div>
                <div class="metric-label">Insurance Premium</div>
                <div class="metric-value" id="premium-metric">$8.5K</div>
                <div class="metric-delta" id="premium-delta">Properly covered</div>
            </div>
            
            <div class="metric-card" style="--metric-color: #AF52DE">
                <div class="metric-icon">üë•</div>
                <div class="metric-label">Team Size</div>
                <div class="metric-value" id="team-metric">4</div>
                <div class="metric-delta" id="team-delta">Founder + 3</div>
            </div>
            
            <div class="metric-card" style="--metric-color: #FF9500">
                <div class="metric-icon">üìä</div>
                <div class="metric-label">Risk Level</div>
                <div class="metric-value" id="risk-metric">Low</div>
                <div class="metric-delta" id="risk-delta">Subcontractor focus</div>
            </div>
        </div>

        <!-- Business Evolution -->
        <div class="evolution-container">
            <h2 class="evolution-title">Business Evolution Pathway</h2>
            <div class="evolution-canvas">
                <div class="evolution-stage stage-1 active" id="stage-1">
                    <div class="stage-name">Subcontractor</div>
                    <div class="stage-details">Fences & Decks</div>
                </div>
                <div class="evolution-stage stage-2" id="stage-2">
                    <div class="stage-name">Specialist</div>
                    <div class="stage-details">Metal & Complex</div>
                </div>
                <div class="evolution-stage stage-3" id="stage-3">
                    <div class="stage-name">Prime Sub</div>
                    <div class="stage-details">Direct Contracts</div>
                </div>
                <div class="evolution-stage stage-4" id="stage-4">
                    <div class="stage-name">General Contractor</div>
                    <div class="stage-details">Full Service</div>
                </div>
                <div class="evolution-stage stage-5" id="stage-5">
                    <div class="stage-name">Enterprise</div>
                    <div class="stage-details">Multi-State</div>
                </div>
            </div>
        </div>

        <!-- Risk vs Coverage Timeline -->
        <div class="risk-timeline">
            <h2 class="evolution-title">Risk Exposure vs. Coverage Over Time</h2>
            <div class="risk-chart">
                <svg width="100%" height="200" id="risk-svg">
                    <defs>
                        <linearGradient id="riskGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#FF3B30;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#FF9500;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="coverageGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#34C759;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#007AFF;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <path id="risk-path" class="risk-line" stroke="url(#riskGradient)" />
                    <path id="coverage-path" class="coverage-line" stroke="url(#coverageGradient)" />
                </svg>
            </div>
        </div>

        <!-- Milestone Events -->
        <div class="milestones-grid">
            <div class="milestone-card" style="--milestone-color: #007AFF">
                <div class="milestone-year">YEAR 1</div>
                <div class="milestone-title">Coverage Foundation</div>
                <div class="milestone-description">
                    Establish proper GL, Workers Comp, and meet College Station's $5M pollution requirement. 
                    Begin safety program implementation.
                </div>
            </div>
            
            <div class="milestone-card" style="--milestone-color: #AF52DE">
                <div class="milestone-year">YEAR 3</div>
                <div class="milestone-title">Scale Threshold</div>
                <div class="milestone-description">
                    Add umbrella policy, upgrade to $2M GL limits. 
                    Qualify for larger commercial projects and government contracts.
                </div>
            </div>
            
            <div class="milestone-card" style="--milestone-color: #34C759">
                <div class="milestone-year">YEAR 5</div>
                <div class="milestone-title">GC Transition</div>
                <div class="milestone-description">
                    Professional liability, bonding capacity, $5M umbrella. 
                    Full general contractor insurance program activated.
                </div>
            </div>
            
            <div class="milestone-card" style="--milestone-color: #FF9500">
                <div class="milestone-year">YEAR 7</div>
                <div class="milestone-title">Regional Expansion</div>
                <div class="milestone-description">
                    Multi-state coverage, fleet insurance program, 
                    key person life insurance for leadership.
                </div>
            </div>
            
            <div class="milestone-card" style="--milestone-color: #FF3B30">
                <div class="milestone-year">YEAR 10</div>
                <div class="milestone-title">Enterprise Protection</div>
                <div class="milestone-description">
                    Directors & Officers liability, cyber insurance, 
                    employment practices liability. Consider captive insurance.
                </div>
            </div>
            
            <div class="milestone-card" style="--milestone-color: #5AC8FA">
                <div class="milestone-year">YEAR 20</div>
                <div class="milestone-title">Legacy Planning</div>
                <div class="milestone-description">
                    Succession planning insurance, buy-sell agreements, 
                    potential acquisition or IPO preparation coverage.
                </div>
            </div>
        </div>

        <!-- Decision Points -->
        <div class="decision-panel">
            <h2 class="decision-title">
                <span>üéØ</span>
                <span id="decision-title">Critical Decisions for 2025</span>
            </h2>
            <div class="decisions-list" id="decisions-list">
                <div class="decision-item">
                    <div class="decision-icon">‚ö°</div>
                    <div class="decision-content">
                        <div class="decision-text">Immediately secure $5M pollution liability</div>
                        <div class="decision-impact">Compliance risk: $100K+ fines possible</div>
                    </div>
                    <div class="decision-action">Act Now</div>
                </div>
                
                <div class="decision-item">
                    <div class="decision-icon">üìã</div>
                    <div class="decision-content">
                        <div class="decision-text">Implement written safety program</div>
                        <div class="decision-impact">Premium savings: 15-25% reduction</div>
                    </div>
                    <div class="decision-action">Q1 2025</div>
                </div>
                
                <div class="decision-item">
                    <div class="decision-icon">üéØ</div>
                    <div class="decision-content">
                        <div class="decision-text">Choose insurance broker partnership</div>
                        <div class="decision-impact">Long-term relationship critical for growth</div>
                    </div>
                    <div class="decision-action">This Month</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Timeline data
        const timelineData = [
            {
                year: 2025,
                yearLabel: 'Y0',
                revenue: 750000,
                premium: 8500,
                team: 4,
                risk: 'Low',
                stage: 1,
                context: 'Starting Point - $750K Revenue',
                decisions: [
                    { icon: '‚ö°', text: 'Immediately secure $5M pollution liability', impact: 'Compliance risk: $100K+ fines possible', action: 'Act Now' },
                    { icon: 'üìã', text: 'Implement written safety program', impact: 'Premium savings: 15-25% reduction', action: 'Q1 2025' },
                    { icon: 'üéØ', text: 'Choose insurance broker partnership', impact: 'Long-term relationship critical for growth', action: 'This Month' }
                ]
            },
            {
                year: 2026,
                yearLabel: 'Y1',
                revenue: 1000000,
                premium: 12000,
                team: 6,
                risk: 'Low-Med',
                stage: 1,
                context: 'Growth Phase - $1M Revenue',
                decisions: [
                    { icon: 'üìà', text: 'Increase GL limits to $2M', impact: 'Access to larger contracts', action: 'Q2 2026' },
                    { icon: 'üöö', text: 'Add second work vehicle', impact: 'Fleet insurance considerations', action: 'As needed' },
                    { icon: 'üë•', text: 'Hire safety coordinator', impact: 'Reduce workers comp claims', action: 'Q3 2026' }
                ]
            },
            {
                year: 2027,
                yearLabel: 'Y2',
                revenue: 1500000,
                premium: 18000,
                team: 8,
                risk: 'Medium',
                stage: 2,
                context: 'Scaling Operations - $1.5M Revenue',
                decisions: [
                    { icon: '‚òÇÔ∏è', text: 'Add $5M umbrella policy', impact: 'Catastrophic loss protection', action: 'Q1 2027' },
                    { icon: 'üèóÔ∏è', text: "Consider builder's risk", impact: 'Project-specific coverage', action: 'Per project' },
                    { icon: 'üíº', text: 'Evaluate professional liability', impact: 'Design-build protection', action: 'Q4 2027' }
                ]
            },
            {
                year: 2028,
                yearLabel: 'Y3',
                revenue: 2000000,
                premium: 25000,
                team: 12,
                risk: 'Medium',
                stage: 2,
                context: 'Established Specialist - $2M Revenue',
                decisions: [
                    { icon: 'üéØ', text: 'Pursue state contracts', impact: 'Higher insurance requirements', action: 'Q2 2028' },
                    { icon: 'üè¢', text: 'Lease equipment yard', impact: 'Property insurance needed', action: 'Q3 2028' },
                    { icon: 'üìä', text: 'Implement ERM program', impact: 'Enterprise risk management', action: 'Q4 2028' }
                ]
            },
            {
                year: 2030,
                yearLabel: 'Y5',
                revenue: 3500000,
                premium: 45000,
                team: 20,
                risk: 'Med-High',
                stage: 3,
                context: 'Prime Contractor - $3.5M Revenue',
                decisions: [
                    { icon: 'üèóÔ∏è', text: 'GC license acquisition', impact: 'Transform business model', action: 'Strategic' },
                    { icon: 'üí∞', text: 'Bonding capacity $5M+', impact: 'Public works access', action: 'Establish' },
                    { icon: 'üõ°Ô∏è', text: 'Professional liability mandatory', impact: 'Design liability coverage', action: 'Immediate' }
                ]
            },
            {
                year: 2035,
                yearLabel: 'Y10',
                revenue: 8000000,
                premium: 120000,
                team: 40,
                risk: 'High',
                stage: 4,
                context: 'Regional General Contractor - $8M Revenue',
                decisions: [
                    { icon: 'üåê', text: 'Multi-state expansion', impact: 'Complex compliance needs', action: 'Planned' },
                    { icon: 'üíº', text: 'D&O insurance', impact: 'Board protection', action: 'Required' },
                    { icon: 'üîí', text: 'Cyber liability coverage', impact: 'Data breach protection', action: 'Critical' }
                ]
            },
            {
                year: 2040,
                yearLabel: 'Y15',
                revenue: 15000000,
                premium: 250000,
                team: 75,
                risk: 'High',
                stage: 4,
                context: 'Major Regional Player - $15M Revenue',
                decisions: [
                    { icon: 'üè¢', text: 'Captive insurance evaluation', impact: 'Self-insurance options', action: 'Analyze' },
                    { icon: 'üåç', text: 'International projects', impact: 'Global coverage needs', action: 'Opportunity' },
                    { icon: 'ü§ù', text: 'M&A insurance', impact: 'Acquisition protection', action: 'Strategic' }
                ]
            },
            {
                year: 2045,
                yearLabel: 'Y20',
                revenue: 25000000,
                premium: 400000,
                team: 120,
                risk: 'Enterprise',
                stage: 5,
                context: 'Enterprise Construction Firm - $25M Revenue',
                decisions: [
                    { icon: 'üèõÔ∏è', text: 'Succession planning', impact: 'Leadership transition', action: 'Essential' },
                    { icon: 'üìà', text: 'IPO consideration', impact: 'Public company insurance', action: 'Evaluate' },
                    { icon: 'üåü', text: 'Legacy protection', impact: 'Reputation insurance', action: 'Preserve' }
                ]
            }
        ];

        let currentIndex = 0;
        let isDragging = false;

        // Initialize particles
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(particle);
            }
        }

        // Create timeline markers
        function createMarkers() {
            const markersContainer = document.getElementById('timeline-markers');
            timelineData.forEach((data, index) => {
                const marker = document.createElement('div');
                marker.className = 'marker';
                if (index === 0) marker.classList.add('active');
                if ([2, 4, 5, 7].includes(index)) marker.classList.add('milestone');
                
                const dot = document.createElement('div');
                dot.className = 'marker-dot';
                
                const label = document.createElement('div');
                label.className = 'marker-label';
                label.textContent = data.yearLabel;
                
                marker.appendChild(dot);
                marker.appendChild(label);
                marker.addEventListener('click', () => setYear(index));
                
                markersContainer.appendChild(marker);
            });
        }

        // Update display based on year
        function updateDisplay(index) {
            const data = timelineData[index];
            
            // Update year display
            document.getElementById('current-year').textContent = data.year;
            document.getElementById('year-context').textContent = data.context;
            
            // Update metrics with animation
            animateValue('revenue-metric', formatCurrency(data.revenue));
            animateValue('premium-metric', formatCurrency(data.premium));
            animateValue('team-metric', data.team.toString());
            animateValue('risk-metric', data.risk);
            
            // Update deltas
            if (index === 0) {
                document.getElementById('revenue-delta').textContent = 'Base year';
                document.getElementById('premium-delta').textContent = 'Properly covered';
                document.getElementById('team-delta').textContent = 'Founder + 3';
                document.getElementById('risk-delta').textContent = 'Subcontractor focus';
            } else {
                const prevData = timelineData[index - 1];
                const revGrowth = ((data.revenue - prevData.revenue) / prevData.revenue * 100).toFixed(0);
                const premGrowth = ((data.premium - prevData.premium) / prevData.premium * 100).toFixed(0);
                
                document.getElementById('revenue-delta').textContent = `+${revGrowth}% from previous`;
                document.getElementById('premium-delta').textContent = `+${premGrowth}% from previous`;
                document.getElementById('team-delta').textContent = `+${data.team - prevData.team} employees`;
                document.getElementById('risk-delta').textContent = getRiskContext(data.risk);
            }
            
            // Update business evolution stages
            document.querySelectorAll('.evolution-stage').forEach(stage => {
                stage.classList.remove('active');
            });
            document.getElementById(`stage-${data.stage}`).classList.add('active');
            
            // Update decisions
            updateDecisions(data);
            
            // Update timeline handle position
            const position = (index / (timelineData.length - 1)) * 100;
            document.getElementById('timeline-handle').style.left = position + '%';
            document.getElementById('handle-year').textContent = data.yearLabel;
            
            // Update markers
            document.querySelectorAll('.marker').forEach((marker, i) => {
                marker.classList.toggle('active', i === index);
            });
            
            // Update risk chart
            updateRiskChart(index);
        }

        // Update decisions panel
        function updateDecisions(data) {
            document.getElementById('decision-title').textContent = `Critical Decisions for ${data.year}`;
            const list = document.getElementById('decisions-list');
            list.innerHTML = '';
            
            data.decisions.forEach(decision => {
                const item = document.createElement('div');
                item.className = 'decision-item';
                item.innerHTML = `
                    <div class="decision-icon">${decision.icon}</div>
                    <div class="decision-content">
                        <div class="decision-text">${decision.text}</div>
                        <div class="decision-impact">${decision.impact}</div>
                    </div>
                    <div class="decision-action">${decision.action}</div>
                `;
                list.appendChild(item);
            });
        }

        // Update risk vs coverage chart
        function updateRiskChart(index) {
            const svg = document.getElementById('risk-svg');
            const width = svg.clientWidth;
            const height = 200;
            
            // Generate path data
            let riskPath = 'M 0,180 ';
            let coveragePath = 'M 0,150 ';
            
            for (let i = 0; i <= index; i++) {
                const x = (i / (timelineData.length - 1)) * width;
                const riskY = 180 - (timelineData[i].revenue / 25000000) * 150;
                const coverageY = 180 - (timelineData[i].premium / 400000) * 150;
                
                riskPath += `L ${x},${riskY} `;
                coveragePath += `L ${x},${coverageY} `;
            }
            
            document.getElementById('risk-path').setAttribute('d', riskPath);
            document.getElementById('coverage-path').setAttribute('d', coveragePath);
        }

        // Format currency
        function formatCurrency(value) {
            if (value >= 1000000) {
                return '$' + (value / 1000000).toFixed(1) + 'M';
            } else if (value >= 1000) {
                return '$' + (value / 1000).toFixed(0) + 'K';
            }
            return '$' + value;
        }

        // Get risk context
        function getRiskContext(risk) {
            const contexts = {
                'Low': 'Manageable exposure',
                'Low-Med': 'Growing complexity',
                'Medium': 'Active management needed',
                'Med-High': 'Significant exposure',
                'High': 'Enterprise risk level',
                'Enterprise': 'Board oversight required'
            };
            return contexts[risk] || 'Evolving risk profile';
        }

        // Animate value changes
        function animateValue(elementId, newValue) {
            const element = document.getElementById(elementId);
            element.style.transform = 'scale(1.1)';
            element.style.color = '#007AFF';
            setTimeout(() => {
                element.textContent = newValue;
                element.style.transform = 'scale(1)';
                element.style.color = '';
            }, 300);
        }

        // Set year by index
        function setYear(index) {
            currentIndex = index;
            updateDisplay(index);
        }

        // Timeline interaction
        const slider = document.getElementById('timeline-slider');
        const handle = document.getElementById('timeline-handle');

        handle.addEventListener('mousedown', startDrag);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', endDrag);

        slider.addEventListener('click', (e) => {
            if (!isDragging) {
                const rect = slider.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const percent = x / rect.width;
                const index = Math.round(percent * (timelineData.length - 1));
                setYear(Math.max(0, Math.min(timelineData.length - 1, index)));
            }
        });

        function startDrag(e) {
            isDragging = true;
            handle.style.cursor = 'grabbing';
            e.preventDefault();
        }

        function drag(e) {
            if (!isDragging) return;
            
            const rect = slider.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const percent = Math.max(0, Math.min(1, x / rect.width));
            const index = Math.round(percent * (timelineData.length - 1));
            
            if (index !== currentIndex) {
                setYear(index);
            }
        }

        function endDrag() {
            isDragging = false;
            handle.style.cursor = 'grab';
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' && currentIndex > 0) {
                setYear(currentIndex - 1);
            } else if (e.key === 'ArrowRight' && currentIndex < timelineData.length - 1) {
                setYear(currentIndex + 1);
            }
        });

        // Initialize
        createParticles();
        createMarkers();
        updateDisplay(0);
    </script>
</body>
</html>