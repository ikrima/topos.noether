<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clippy's Quantifier Quest</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=VT323&family=Pixelify+Sans:wght@400;700&family=MS+Sans+Serif&display=swap" rel="stylesheet">
<style>
  @font-face {
    font-family: 'W95FA';
    src: local('MS Sans Serif'), local('Segoe UI'), local('Tahoma');
  }

  :root {
    --win-bg: #008080;
    --win-gray: #c0c0c0;
    --win-dark: #808080;
    --win-light: #ffffff;
    --win-blue: #000080;
    --win-btn-face: #c0c0c0;
    --title-blue: #000080;
    --win-shadow-dark: #404040;
    --win-shadow-light: #dfdfdf;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Pixelify Sans', 'Tahoma', 'MS Sans Serif', sans-serif;
    background: var(--win-bg);
    min-height: 100vh;
    overflow: hidden;
    cursor: default;
    image-rendering: auto;
  }

  /* Desktop icons */
  .desktop-icon {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 4px;
    cursor: pointer;
    width: 80px;
    text-align: center;
  }
  .desktop-icon:hover { background: rgba(255,255,255,0.1); }
  .desktop-icon span {
    color: white;
    font-size: 11px;
    text-shadow: 1px 1px 1px rgba(0,0,0,0.8);
    font-family: 'Pixelify Sans', sans-serif;
  }

  /* Win98 Window Chrome */
  .win98-window {
    background: var(--win-gray);
    border-top: 2px solid var(--win-light);
    border-left: 2px solid var(--win-light);
    border-right: 2px solid var(--win-shadow-dark);
    border-bottom: 2px solid var(--win-shadow-dark);
    box-shadow: 1px 1px 0 #000;
    position: absolute;
  }
  .win98-titlebar {
    background: linear-gradient(90deg, var(--title-blue), #1084d0);
    color: white;
    padding: 3px 4px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-weight: bold;
    font-size: 13px;
    font-family: 'Pixelify Sans', sans-serif;
    user-select: none;
  }
  .win98-titlebar-buttons {
    display: flex;
    gap: 2px;
  }
  .win98-btn {
    width: 16px;
    height: 14px;
    background: var(--win-btn-face);
    border-top: 1px solid var(--win-light);
    border-left: 1px solid var(--win-light);
    border-right: 1px solid var(--win-shadow-dark);
    border-bottom: 1px solid var(--win-shadow-dark);
    font-size: 9px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-family: 'Pixelify Sans', sans-serif;
  }
  .win98-btn:active {
    border-top: 1px solid var(--win-shadow-dark);
    border-left: 1px solid var(--win-shadow-dark);
    border-right: 1px solid var(--win-light);
    border-bottom: 1px solid var(--win-light);
  }
  .win98-menubar {
    background: var(--win-gray);
    padding: 2px 0;
    border-bottom: 1px solid var(--win-dark);
    display: flex;
    gap: 0;
    font-size: 12px;
  }
  .win98-menubar span {
    padding: 2px 8px;
    cursor: pointer;
    font-family: 'Pixelify Sans', sans-serif;
  }
  .win98-menubar span:hover { background: var(--title-blue); color: white; }
  .win98-content {
    background: white;
    margin: 3px;
    padding: 12px;
    border-top: 1px solid var(--win-shadow-dark);
    border-left: 1px solid var(--win-shadow-dark);
    border-right: 1px solid var(--win-light);
    border-bottom: 1px solid var(--win-light);
    overflow-y: auto;
  }
  .win98-statusbar {
    background: var(--win-gray);
    border-top: 1px solid var(--win-dark);
    padding: 2px 6px;
    font-size: 11px;
    display: flex;
    justify-content: space-between;
    font-family: 'Pixelify Sans', sans-serif;
  }

  /* Inset border helper */
  .inset {
    border-top: 1px solid var(--win-shadow-dark);
    border-left: 1px solid var(--win-shadow-dark);
    border-right: 1px solid var(--win-light);
    border-bottom: 1px solid var(--win-light);
  }
  .outset {
    border-top: 2px solid var(--win-light);
    border-left: 2px solid var(--win-light);
    border-right: 2px solid var(--win-shadow-dark);
    border-bottom: 2px solid var(--win-shadow-dark);
  }

  /* Clippy Character */
  .clippy-container {
    position: fixed;
    bottom: 40px;
    right: 20px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    transition: all 0.3s ease;
  }

  .clippy-bubble {
    background: #ffffcc;
    border: 2px solid #000;
    border-radius: 12px;
    padding: 12px 16px;
    max-width: 280px;
    font-size: 13px;
    font-family: 'Pixelify Sans', 'Tahoma', sans-serif;
    margin-bottom: 8px;
    position: relative;
    box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    animation: bubblePop 0.3s ease-out;
    line-height: 1.4;
  }
  .clippy-bubble::after {
    content: '';
    position: absolute;
    bottom: -10px;
    right: 30px;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-top: 10px solid #ffffcc;
  }
  .clippy-bubble::before {
    content: '';
    position: absolute;
    bottom: -13px;
    right: 28px;
    border-left: 12px solid transparent;
    border-right: 12px solid transparent;
    border-top: 12px solid #000;
  }

  .clippy-bubble-btn {
    display: inline-block;
    margin-top: 8px;
    padding: 3px 16px;
    background: var(--win-btn-face);
    border-top: 2px solid var(--win-light);
    border-left: 2px solid var(--win-light);
    border-right: 2px solid var(--win-shadow-dark);
    border-bottom: 2px solid var(--win-shadow-dark);
    font-size: 12px;
    cursor: pointer;
    font-family: 'Pixelify Sans', sans-serif;
  }
  .clippy-bubble-btn:active {
    border-top: 2px solid var(--win-shadow-dark);
    border-left: 2px solid var(--win-shadow-dark);
    border-right: 2px solid var(--win-light);
    border-bottom: 2px solid var(--win-light);
  }

  @keyframes bubblePop {
    0% { transform: scale(0.7); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
  }

  /* Clippy SVG animations */
  .clippy-body {
    width: 110px;
    height: 130px;
    cursor: pointer;
    transition: transform 0.2s;
    filter: drop-shadow(2px 3px 3px rgba(0,0,0,0.3));
  }
  .clippy-body:hover { transform: scale(1.05); }

  @keyframes clippy-blink {
    0%, 90%, 100% { transform: scaleY(1); }
    95% { transform: scaleY(0.1); }
  }
  @keyframes clippy-idle {
    0%, 100% { transform: rotate(0deg) translateY(0); }
    25% { transform: rotate(2deg) translateY(-3px); }
    75% { transform: rotate(-2deg) translateY(-1px); }
  }
  @keyframes clippy-bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-15px); }
  }
  @keyframes clippy-wave {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(15deg); }
    50% { transform: rotate(-10deg); }
    75% { transform: rotate(12deg); }
  }
  .clippy-idle { animation: clippy-idle 3s ease-in-out infinite; }
  .clippy-bounce { animation: clippy-bounce 0.5s ease-in-out 3; }
  .clippy-wave { animation: clippy-wave 0.8s ease-in-out 2; }

  .clippy-eyes { animation: clippy-blink 4s infinite; transform-origin: center; }

  /* Matching UI */
  .expression-card {
    background: #e8e8ff;
    border: 2px solid #666;
    padding: 8px 14px;
    margin: 6px 0;
    font-family: 'VT323', 'Courier New', monospace;
    font-size: 18px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.15s;
    user-select: none;
    border-top: 2px solid var(--win-light);
    border-left: 2px solid var(--win-light);
    border-right: 2px solid var(--win-shadow-dark);
    border-bottom: 2px solid var(--win-shadow-dark);
  }
  .expression-card:hover {
    background: #d0d0ff;
    transform: translateX(3px);
  }
  .expression-card.selected {
    background: #000080;
    color: white;
    border-color: #000040;
  }
  .expression-card.correct {
    background: #90ee90;
    border-color: #228b22;
    color: #003300;
  }
  .expression-card.wrong {
    background: #ffcccc;
    border-color: #cc0000;
    animation: shake 0.4s;
  }

  .phrase-card {
    background: #fff8e0;
    border: 2px solid #888;
    padding: 8px 14px;
    margin: 6px 0;
    font-size: 14px;
    font-family: 'Pixelify Sans', sans-serif;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.15s;
    user-select: none;
    border-top: 2px solid var(--win-light);
    border-left: 2px solid var(--win-light);
    border-right: 2px solid var(--win-shadow-dark);
    border-bottom: 2px solid var(--win-shadow-dark);
  }
  .phrase-card:hover {
    background: #fff0b0;
    transform: translateX(-3px);
  }
  .phrase-card.selected {
    background: #000080;
    color: white;
  }
  .phrase-card.correct {
    background: #90ee90;
    border-color: #228b22;
    color: #003300;
  }
  .phrase-card.wrong {
    background: #ffcccc;
    border-color: #cc0000;
    animation: shake 0.4s;
  }
  .phrase-card.matched {
    opacity: 0.5;
    pointer-events: none;
  }

  .match-slot {
    width: 24px;
    height: 24px;
    border: 2px dashed #999;
    border-radius: 4px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 13px;
    flex-shrink: 0;
    background: white;
  }
  .match-slot.filled {
    border-style: solid;
    border-color: #000080;
    background: #e0e0ff;
    color: #000080;
  }
  .match-slot.correct {
    border-color: #228b22;
    background: #c0ffc0;
    color: #005500;
  }

  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-8px); }
    75% { transform: translateX(8px); }
  }

  /* Taskbar */
  .taskbar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 32px;
    background: var(--win-gray);
    border-top: 2px solid var(--win-light);
    display: flex;
    align-items: center;
    padding: 0 4px;
    gap: 4px;
    z-index: 10000;
    font-family: 'Pixelify Sans', sans-serif;
  }
  .start-btn {
    background: var(--win-btn-face);
    border-top: 2px solid var(--win-light);
    border-left: 2px solid var(--win-light);
    border-right: 2px solid var(--win-shadow-dark);
    border-bottom: 2px solid var(--win-shadow-dark);
    padding: 2px 8px;
    font-weight: bold;
    font-size: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    font-family: 'Pixelify Sans', sans-serif;
  }
  .taskbar-clock {
    margin-left: auto;
    background: var(--win-gray);
    border-top: 1px solid var(--win-shadow-dark);
    border-left: 1px solid var(--win-shadow-dark);
    border-right: 1px solid var(--win-light);
    border-bottom: 1px solid var(--win-light);
    padding: 2px 8px;
    font-size: 12px;
  }
  .taskbar-item {
    background: var(--win-btn-face);
    border-top: 1px solid var(--win-light);
    border-left: 1px solid var(--win-light);
    border-right: 1px solid var(--win-shadow-dark);
    border-bottom: 1px solid var(--win-shadow-dark);
    padding: 2px 12px;
    font-size: 11px;
    cursor: pointer;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 200px;
  }
  .taskbar-item.active {
    border-top: 1px solid var(--win-shadow-dark);
    border-left: 1px solid var(--win-shadow-dark);
    border-right: 1px solid var(--win-light);
    border-bottom: 1px solid var(--win-light);
    background: #b0b0b0;
  }

  /* Score display */
  .score-display {
    font-family: 'VT323', monospace;
    font-size: 22px;
    color: #000080;
  }

  /* Confetti */
  .confetti {
    position: fixed;
    top: -10px;
    z-index: 99999;
    pointer-events: none;
    font-size: 20px;
  }

  /* Victory overlay */
  .victory-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,128,0.85);
    z-index: 99998;
    display: none;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    gap: 20px;
    color: white;
    font-family: 'Pixelify Sans', sans-serif;
  }
  .victory-overlay.show { display: flex; }

  /* Expression formula styling */
  .formula { font-family: 'Times New Roman', Georgia, serif; font-style: italic; }
  .quantifier { font-family: 'Times New Roman', Georgia, serif; font-size: 1.1em; }

  /* Tooltip */
  .tooltip-98 {
    background: #ffffcc;
    border: 1px solid #000;
    padding: 4px 8px;
    font-size: 11px;
    position: absolute;
    z-index: 9999;
    pointer-events: none;
    font-family: 'Pixelify Sans', sans-serif;
    display: none;
  }

  /* Progress bar Win98 style */
  .progress-98 {
    height: 18px;
    background: white;
    border-top: 1px solid var(--win-shadow-dark);
    border-left: 1px solid var(--win-shadow-dark);
    border-right: 1px solid var(--win-light);
    border-bottom: 1px solid var(--win-light);
    overflow: hidden;
  }
  .progress-98-fill {
    height: 100%;
    background: repeating-linear-gradient(
      90deg,
      #000080 0px,
      #000080 8px,
      transparent 8px,
      transparent 10px
    );
    transition: width 0.5s ease;
  }

  /* Scrollbar win98 */
  ::-webkit-scrollbar { width: 16px; }
  ::-webkit-scrollbar-track { background: var(--win-gray); border: 1px solid #808080; }
  ::-webkit-scrollbar-thumb {
    background: var(--win-btn-face);
    border-top: 2px solid var(--win-light);
    border-left: 2px solid var(--win-light);
    border-right: 2px solid var(--win-shadow-dark);
    border-bottom: 2px solid var(--win-shadow-dark);
  }

  /* Hint panel */
  .hint-panel {
    background: #fffff0;
    border: 1px solid #ccc;
    padding: 8px;
    margin-top: 8px;
    font-size: 12px;
    font-family: 'Pixelify Sans', sans-serif;
    display: none;
  }
  .hint-panel.show { display: block; }
</style>
</head>
<body>

<!-- Desktop Icons -->
<div style="position: absolute; top: 16px; left: 16px; display: flex; flex-direction: column; gap: 16px;">
  <div class="desktop-icon">
    <svg width="32" height="32" viewBox="0 0 32 32"><rect x="4" y="2" width="24" height="28" fill="#ffffcc" stroke="#000" stroke-width="1.5"/><rect x="7" y="6" width="18" height="2" fill="#000080"/><rect x="7" y="11" width="18" height="2" fill="#000080"/><rect x="7" y="16" width="14" height="2" fill="#000080"/><rect x="7" y="21" width="18" height="2" fill="#000080"/></svg>
    <span>My Proofs</span>
  </div>
  <div class="desktop-icon">
    <svg width="32" height="32" viewBox="0 0 32 32"><rect x="2" y="8" width="28" height="22" fill="#c8a800" stroke="#000" stroke-width="1"/><rect x="2" y="4" width="14" height="6" fill="#c8a800" stroke="#000" stroke-width="1"/></svg>
    <span>Theorems</span>
  </div>
  <div class="desktop-icon">
    <svg width="32" height="32" viewBox="0 0 32 32"><circle cx="16" cy="16" r="13" fill="#0078d7" stroke="#000" stroke-width="1"/><text x="16" y="22" text-anchor="middle" fill="white" font-size="18" font-weight="bold">‚àÄ</text></svg>
    <span>Quantifier Explorer</span>
  </div>
</div>

<!-- Main Window -->
<div class="win98-window" id="mainWindow" style="left: 50%; top: 46%; transform: translate(-50%, -50%); width: min(95vw, 780px); height: min(88vh, 620px); display: flex; flex-direction: column;">
  <div class="win98-titlebar" id="titlebar">
    <div style="display:flex;align-items:center;gap:6px;">
      <svg width="16" height="16" viewBox="0 0 16 16"><rect x="1" y="1" width="14" height="14" fill="#fff" stroke="#000080" stroke-width="1"/><text x="8" y="12" text-anchor="middle" fill="#000080" font-size="10" font-weight="bold">‚àÉ</text></svg>
      <span>üì® Quantifier Quest ‚Äî Mathematician Mail Matching</span>
    </div>
    <div class="win98-titlebar-buttons">
      <div class="win98-btn" title="Minimize">_</div>
      <div class="win98-btn" title="Maximize">‚ñ°</div>
      <div class="win98-btn" title="Close" onclick="document.getElementById('mainWindow').style.display='none'">‚úï</div>
    </div>
  </div>
  <div class="win98-menubar">
    <span>File</span>
    <span>Edit</span>
    <span onclick="showHints()">Hints</span>
    <span onclick="resetGame()">Reset</span>
    <span onclick="toggleClippy()">Clippy</span>
    <span>Help</span>
  </div>

  <div class="win98-content" style="flex:1; overflow-y:auto;">
    <!-- Header -->
    <div style="text-align:center; margin-bottom: 10px;">
      <div style="font-size: 16px; font-weight: bold; color: #000080; font-family: 'Pixelify Sans', sans-serif;">
        üì¨ The Great Mathematician Mail Matching Challenge üì¨
      </div>
      <div style="font-size: 12px; color: #666; margin-top: 4px; font-family: 'Pixelify Sans', sans-serif;">
        Let <span class="formula">L(a, b)</span> = "Mathematician <span class="formula">a</span> wrote a letter to mathematician <span class="formula">b</span>"
      </div>
    </div>

    <!-- Score & Progress -->
    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
      <span style="font-size:12px; font-family:'Pixelify Sans',sans-serif;">Progress:</span>
      <div class="progress-98" style="flex:1;">
        <div class="progress-98-fill" id="progressFill" style="width: 0%;"></div>
      </div>
      <span class="score-display" id="scoreDisplay">0 / 6</span>
    </div>

    <!-- Matching Grid -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
      <!-- Left: Expressions -->
      <div>
        <div style="font-size:12px; font-weight:bold; color:#000080; margin-bottom:6px; font-family:'Pixelify Sans',sans-serif; border-bottom: 1px solid #ccc; padding-bottom:4px;">
          ‚úèÔ∏è Logical Expressions ‚Äî Click one:
        </div>
        <div id="expressionList"></div>
      </div>

      <!-- Right: Phrases -->
      <div>
        <div style="font-size:12px; font-weight:bold; color:#000080; margin-bottom:6px; font-family:'Pixelify Sans',sans-serif; border-bottom: 1px solid #ccc; padding-bottom:4px;">
          üìù Descriptions ‚Äî Then click a match:
        </div>
        <div id="phraseList"></div>
      </div>
    </div>

    <!-- Hint Panel -->
    <div class="hint-panel" id="hintPanel">
      <strong>üí° Clippy's Hint Corner:</strong>
      <div id="hintText" style="margin-top:4px;"></div>
    </div>
  </div>

  <div class="win98-statusbar">
    <span id="statusText">Select an expression, then click its matching phrase.</span>
    <span id="statusScore">Score: 0 pts</span>
  </div>
</div>

<!-- Clippy -->
<div class="clippy-container" id="clippyContainer">
  <div class="clippy-bubble" id="clippyBubble">
    <div id="clippyText">
      üëã Hi! It looks like you're trying to match quantifiers with humorous descriptions of mathematician mail!<br><br>Would you like help?
    </div>
    <div style="display:flex; gap:6px; flex-wrap:wrap;">
      <div class="clippy-bubble-btn" onclick="clippyRespond('yes')">Get a hint</div>
      <div class="clippy-bubble-btn" onclick="clippyRespond('no')">Go away!</div>
    </div>
  </div>
  <div id="clippyChar" class="clippy-idle" onclick="pokeClippy()">
    <svg class="clippy-body" viewBox="0 0 110 130" xmlns="http://www.w3.org/2000/svg">
      <!-- Paperclip body -->
      <path d="M 35 120 C 35 120 15 110 15 80 C 15 50 30 30 45 20 C 60 10 75 15 80 30 C 85 45 75 70 60 85 C 50 95 40 95 38 85 C 35 72 45 55 55 45 C 62 38 68 42 66 50 C 63 60 55 68 50 68"
        fill="none" stroke="#a0a0a0" stroke-width="10" stroke-linecap="round"/>
      <path d="M 35 120 C 35 120 15 110 15 80 C 15 50 30 30 45 20 C 60 10 75 15 80 30 C 85 45 75 70 60 85 C 50 95 40 95 38 85 C 35 72 45 55 55 45 C 62 38 68 42 66 50 C 63 60 55 68 50 68"
        fill="none" stroke="#d0d0d0" stroke-width="6" stroke-linecap="round"/>

      <!-- Eyes -->
      <g class="clippy-eyes">
        <ellipse cx="48" cy="36" rx="8" ry="9" fill="white" stroke="#666" stroke-width="1.5"/>
        <ellipse cx="68" cy="36" rx="8" ry="9" fill="white" stroke="#666" stroke-width="1.5"/>
        <circle cx="50" cy="37" r="3.5" fill="#222" id="leftPupil"/>
        <circle cx="70" cy="37" r="3.5" fill="#222" id="rightPupil"/>
        <circle cx="51" cy="35" r="1.2" fill="white"/>
        <circle cx="71" cy="35" r="1.2" fill="white"/>
      </g>

      <!-- Eyebrows -->
      <line x1="41" y1="26" x2="54" y2="24" stroke="#666" stroke-width="2" stroke-linecap="round" id="leftBrow"/>
      <line x1="62" y1="24" x2="75" y2="26" stroke="#666" stroke-width="2" stroke-linecap="round" id="rightBrow"/>

      <!-- Mouth -->
      <path d="M 50 50 Q 58 58 66 50" fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" id="clippyMouth"/>

      <!-- Right hand/pointer -->
      <g id="clippyHand" style="transform-origin: 80px 60px;">
        <line x1="80" y1="55" x2="95" y2="42" stroke="#a0a0a0" stroke-width="4" stroke-linecap="round"/>
        <line x1="80" y1="55" x2="95" y2="42" stroke="#d0d0d0" stroke-width="2" stroke-linecap="round"/>
        <circle cx="96" cy="40" r="4" fill="#d0d0d0" stroke="#a0a0a0" stroke-width="1.5"/>
      </g>
    </svg>
  </div>
</div>

<!-- Victory Overlay -->
<div class="victory-overlay" id="victoryOverlay">
  <div style="font-size:48px;">üéâüèÜüéâ</div>
  <div style="font-size:28px; font-family:'Pixelify Sans',sans-serif;">PERFECT SCORE!</div>
  <div style="font-size:16px; font-family:'Pixelify Sans',sans-serif;">All quantifiers matched! Euler would be proud.</div>
  <div style="font-size:14px; opacity:0.8; font-family:'Pixelify Sans',sans-serif;">12 / 12 points</div>
  <div class="clippy-bubble-btn" onclick="resetGame(); document.getElementById('victoryOverlay').classList.remove('show');" style="font-size:16px; padding: 8px 24px;">Play Again</div>
</div>

<!-- Taskbar -->
<div class="taskbar">
  <div class="start-btn">
    <svg width="16" height="16" viewBox="0 0 16 16"><rect x="0" y="0" width="7" height="7" fill="#ff0000"/><rect x="9" y="0" width="7" height="7" fill="#00aa00"/><rect x="0" y="9" width="7" height="7" fill="#0000ff"/><rect x="9" y="9" width="7" height="7" fill="#ffaa00"/></svg>
    Start
  </div>
  <div class="taskbar-item active">üì® Quantifier Quest</div>
  <div class="taskbar-clock" id="taskbarClock">12:00 PM</div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // ========== DATA ==========
  const expressions = [
    { id: 'A', formula: '‚àÉa : ‚àÉb : L(a, b)', raw: '‚àÉa:‚àÉb:L(a,b)' },
    { id: 'B', formula: '‚àÉa : ‚àÄb, L(a, b)', raw: '‚àÉa:‚àÄb,L(a,b)' },
    { id: 'C', formula: '‚àÄa, ‚àÉb : L(a, b)', raw: '‚àÄa,‚àÉb:L(a,b)' },
    { id: 'D', formula: '‚àÄa, ‚àÄb, L(a, b)', raw: '‚àÄa,‚àÄb,L(a,b)' },
    { id: 'E', formula: '‚àÉb : ‚àÄa, L(a, b)', raw: '‚àÉb:‚àÄa,L(a,b)' },
    { id: 'F', formula: '‚àÄb, ‚àÉa : L(a, b)', raw: '‚àÄb,‚àÉa:L(a,b)' },
  ];

  const phrases = [
    { id: 1, text: 'üñäÔ∏è Someone used a lot of ink', answer: 'B' },
    { id: 2, text: 'ü§ó Fortunately, no one felt left out', answer: 'F' },
    { id: 3, text: 'üìÆ The mail carriers were kept busy', answer: 'D' },
    { id: 4, text: '‚≠ê Celebrity mathematician getting fan mail', answer: 'E' },
    { id: 5, text: '‚úâÔ∏è A letter was written', answer: 'A' },
    { id: 6, text: 'üì£ Letter-Writing: Everyone\'s doing it!', answer: 'C' },
  ];

  // ========== STATE ==========
  let selectedExpression = null;
  let matches = {}; // expressionId -> phraseId
  let correctCount = 0;
  let clippyDismissed = false;
  let clippyHintIndex = 0;
  let pokeCount = 0;
  let wrongAttempts = 0;

  const clippyHints = [
    "Think about what ‚àÉ and ‚àÄ mean. ‚àÉ = \"there exists at least one\" and ‚àÄ = \"for all / every\".",
    "When you see ‚àÉa : ‚àÄb, that means ONE person did something to ALL people. That's a LOT of letters! üñäÔ∏è",
    "‚àÄa, ‚àÄb means EVERYONE writes to EVERYONE. Those mail carriers need a raise! üìÆ",
    "‚àÉa : ‚àÉb just means at least one letter exists somewhere. Pretty minimal, right? ‚úâÔ∏è",
    "‚àÉb : ‚àÄa means there's ONE person that EVERYONE writes to. Sounds like a celebrity! ‚≠ê",
    "‚àÄb, ‚àÉa means every person b receives at least one letter. Nobody left out! ü§ó",
    "‚àÄa, ‚àÉb means every person writes to at least someone. Everyone's participating! üì£",
    "Fun fact: The Pascal-Fermat correspondence of 1654 basically invented probability theory. Through MAIL. No Slack, no email, just ink and patience.",
    "I see you're trying to understand first-order logic. Have you considered a career in pure mathematics? The pay is terrible but the notation is beautiful.",
    "Pro tip: Reading quantifiers left-to-right tells you the story. ‚àÄa, ‚àÉb : L(a,b) reads as \"For every mathematician a, there exists some b that a wrote to.\"",
  ];

  const clippyPokes = [
    "Ouch! I'm a paperclip, not a pi√±ata! üìé",
    "Hey! That tickles in a metadata sort of way.",
    "You know, Clippy doesn't forget. I have an ‚àÄ-quantified grudge over all users who poke me.",
    "‚àÉyou : poked(you, me). That's going in my log file.",
    "If ‚àÄuser, poked(user, clippy), then clippy is having a bad day.",
    "Stop that! I'll tell Microsoft Bob!",
    "I'm union, you know. You can't just poke office assistants.",
    "Fun fact: I was voted the most annoying software feature of all time. I'm VERY proud. üèÜ",
    "Look, I'm just trying to help with your quantifiers. Is that so wrong?",
    "Bonzi Buddy never had to deal with this kind of abuse.",
  ];

  const wrongMessages = [
    "Hmm, that doesn't look right! Try reading the quantifiers left to right, like a story. üìñ",
    "Not quite! Remember: ‚àÉ = 'someone' and ‚àÄ = 'everyone'. Who's doing the writing?",
    "Close, but no cigar! Think about WHO is doing WHAT to WHOM. The order matters!",
    "Oops! Let me put it this way: the first quantifier sets the stage, the second tells you the scope.",
    "Wrong match! But hey, even Euler made mistakes. Actually no he didn't. But YOU can!",
    "That's incorrect, but I admire your confidence! ‚àÉconfidence : has(you, confidence) = TRUE",
  ];

  // ========== RENDER ==========
  function render() {
    const exprList = document.getElementById('expressionList');
    const phraseList = document.getElementById('phraseList');

    exprList.innerHTML = '';
    phraseList.innerHTML = '';

    expressions.forEach(expr => {
      const isMatched = matches[expr.id] !== undefined;
      const isCorrect = isMatched && phrases.find(p => p.id === matches[expr.id])?.answer === expr.id;
      const card = document.createElement('div');
      card.className = 'expression-card' +
        (selectedExpression === expr.id ? ' selected' : '') +
        (isCorrect ? ' correct' : '');
      card.innerHTML = `
        <span style="font-weight:bold; min-width:20px;">${expr.id})</span>
        <span class="formula" style="font-size:17px;">${expr.formula}</span>
        ${isMatched ? `<span class="match-slot filled ${isCorrect ? 'correct' : ''}" style="margin-left:auto;">${phrases.find(p=>p.id===matches[expr.id])?.id || '?'}</span>` : '<span class="match-slot" style="margin-left:auto;">?</span>'}
      `;
      if (!isCorrect) {
        card.onclick = () => selectExpression(expr.id);
      }
      exprList.appendChild(card);
    });

    phrases.forEach(phrase => {
      const isUsed = Object.values(matches).includes(phrase.id);
      const matchedExpr = Object.keys(matches).find(k => matches[k] === phrase.id);
      const isCorrect = matchedExpr && phrase.answer === matchedExpr;
      const card = document.createElement('div');
      card.className = 'phrase-card' +
        (isCorrect ? ' correct' : '') +
        (isUsed && !isCorrect ? ' matched' : '');
      card.innerHTML = `
        <span class="match-slot ${isUsed ? (isCorrect ? 'correct filled' : 'filled') : ''}" style="font-size:11px;">${isUsed ? matchedExpr : '?'}</span>
        <span>${phrase.text}</span>
      `;
      if (!isUsed || !isCorrect) {
        card.onclick = () => selectPhrase(phrase.id);
      }
      phraseList.appendChild(card);
    });

    // Update progress
    const correctMatches = Object.keys(matches).filter(k => {
      const phraseId = matches[k];
      const phrase = phrases.find(p => p.id === phraseId);
      return phrase && phrase.answer === k;
    });
    correctCount = correctMatches.length;
    document.getElementById('progressFill').style.width = `${(correctCount / 6) * 100}%`;
    document.getElementById('scoreDisplay').textContent = `${correctCount} / 6`;
    document.getElementById('statusScore').textContent = `Score: ${correctCount * 2} pts`;
  }

  function selectExpression(id) {
    // If already matched incorrectly, unmatch it
    if (matches[id] !== undefined) {
      const phraseId = matches[id];
      const phrase = phrases.find(p => p.id === phraseId);
      if (phrase && phrase.answer !== id) {
        delete matches[id];
      }
    }
    selectedExpression = id;
    document.getElementById('statusText').textContent = `Selected ${id}. Now click the matching description ‚Üí`;
    render();
  }

  function selectPhrase(phraseId) {
    if (!selectedExpression) {
      document.getElementById('statusText').textContent = '‚ö†Ô∏è Select an expression on the left first!';
      shakeClippy();
      return;
    }

    const phrase = phrases.find(p => p.id === phraseId);
    const isCorrect = phrase.answer === selectedExpression;

    // Remove old match for this expression if exists
    if (matches[selectedExpression] !== undefined) {
      delete matches[selectedExpression];
    }
    // Remove old match for this phrase if exists
    Object.keys(matches).forEach(k => {
      if (matches[k] === phraseId) delete matches[k];
    });

    matches[selectedExpression] = phraseId;

    if (isCorrect) {
      document.getElementById('statusText').textContent = `‚úÖ Correct! ${selectedExpression} ‚Üí "${phrase.text}"`;
      clippyCorrect();
    } else {
      wrongAttempts++;
      document.getElementById('statusText').textContent = `‚ùå Not quite! Try again.`;

      // Show wrong animation briefly then remove match
      render();
      const exprCards = document.querySelectorAll('.expression-card');
      const phraseCards = document.querySelectorAll('.phrase-card');
      exprCards.forEach(c => {
        if (c.querySelector('span')?.textContent?.includes(selectedExpression + ')')) {
          c.classList.add('wrong');
          setTimeout(() => c.classList.remove('wrong'), 500);
        }
      });

      setTimeout(() => {
        delete matches[selectedExpression];
        render();
      }, 800);

      clippyWrong();
    }

    selectedExpression = null;
    render();

    // Check for victory
    const allCorrect = Object.keys(matches).filter(k => {
      const p = phrases.find(pp => pp.id === matches[k]);
      return p && p.answer === k;
    });
    if (allCorrect.length === 6) {
      setTimeout(victory, 600);
    }
  }

  // ========== CLIPPY LOGIC ==========
  function clippySpeak(text, showButtons = false) {
    if (clippyDismissed) return;
    const bubble = document.getElementById('clippyBubble');
    const textEl = document.getElementById('clippyText');
    bubble.style.display = 'block';
    textEl.innerHTML = text;
    if (showButtons) {
      textEl.innerHTML += `<div style="display:flex; gap:6px; flex-wrap:wrap; margin-top:8px;">
        <div class="clippy-bubble-btn" onclick="clippyRespond('yes')">Get a hint</div>
        <div class="clippy-bubble-btn" onclick="clippyRespond('no')">Go away!</div>
      </div>`;
    }
    bubble.style.animation = 'none';
    bubble.offsetHeight;
    bubble.style.animation = 'bubblePop 0.3s ease-out';
  }

  function clippyCorrect() {
    const msgs = [
      "üéâ Excellent! You matched that perfectly! Are you secretly a logician?",
      "‚úÖ Correct! Even G√∂del would approve. (Well, he'd probably find a paradox, but still!)",
      "üåü Brilliant! Your quantifier skills are ‚àÄ-encompassing!",
      "üéØ Nailed it! The mail carriers would be impressed by your sorting skills.",
      "üíØ Perfect match! You're making this look easy. Almost... too easy. ü§î",
      "üèÖ Yes! That's the one! I'd give you a gold star but I'm a paperclip.",
    ];
    const idx = Math.min(correctCount, msgs.length - 1);
    clippySpeak(msgs[idx]);
    animateClippy('bounce');
  }

  function clippyWrong() {
    const msg = wrongMessages[wrongAttempts % wrongMessages.length];
    clippySpeak(msg, true);
    animateClippy('wave');
  }

  function shakeClippy() {
    clippySpeak("üëà Click an expression on the <b>left</b> first, then match it to a description on the <b>right</b>!");
  }

  window.pokeClippy = function() {
    const msg = clippyPokes[pokeCount % clippyPokes.length];
    clippySpeak(msg);
    pokeCount++;
    animateClippy('wave');
  };

  window.clippyRespond = function(response) {
    if (response === 'yes') {
      const hint = clippyHints[clippyHintIndex % clippyHints.length];
      clippyHintIndex++;
      clippySpeak(hint, true);
    } else {
      clippySpeak("Fine, I'll be quiet... for now. üò§<br><small>(Click me if you change your mind!)</small>");
      setTimeout(() => {
        document.getElementById('clippyBubble').style.display = 'none';
        clippyDismissed = true;
        // Come back after a while
        setTimeout(() => {
          clippyDismissed = false;
          clippySpeak("I'm back! Did you miss me? üòä<br>I bet you need help with those quantifiers!", true);
        }, 20000);
      }, 2000);
    }
  };

  window.toggleClippy = function() {
    const container = document.getElementById('clippyContainer');
    if (container.style.display === 'none') {
      container.style.display = 'flex';
      clippyDismissed = false;
      clippySpeak("I'm back, baby! üìé‚ú® Need a hint?", true);
    } else {
      container.style.display = 'none';
      clippyDismissed = true;
    }
  };

  function animateClippy(type) {
    const el = document.getElementById('clippyChar');
    el.className = '';
    el.offsetHeight;
    el.className = `clippy-${type}`;
    setTimeout(() => { el.className = 'clippy-idle'; }, type === 'bounce' ? 1500 : 1600);
  }

  // ========== HINTS ==========
  window.showHints = function() {
    const panel = document.getElementById('hintPanel');
    panel.classList.toggle('show');
    if (panel.classList.contains('show')) {
      document.getElementById('hintText').innerHTML = `
        <p>üîë <b>Key insight:</b> Read quantifiers left-to-right like a sentence.</p>
        <p style="margin-top:4px;">‚Ä¢ <b>‚àÉa : ‚àÉb</b> ‚Üí "there is someone (a) who wrote to someone (b)" ‚Äî minimal claim</p>
        <p>‚Ä¢ <b>‚àÉa : ‚àÄb</b> ‚Üí "there's ONE person who wrote to EVERYONE" ‚Äî one prolific writer</p>
        <p>‚Ä¢ <b>‚àÄa, ‚àÉb</b> ‚Üí "EVERYONE wrote to at least SOMEONE" ‚Äî universal participation</p>
        <p>‚Ä¢ <b>‚àÄa, ‚àÄb</b> ‚Üí "EVERYONE wrote to EVERYONE" ‚Äî maximum mail</p>
        <p>‚Ä¢ <b>‚àÉb : ‚àÄa</b> ‚Üí "there's ONE person EVERYONE wrote to" ‚Äî one popular recipient</p>
        <p>‚Ä¢ <b>‚àÄb, ‚àÉa</b> ‚Üí "EVERYONE received at least one letter" ‚Äî no one left out</p>
      `;
    }
  };

  // ========== RESET ==========
  window.resetGame = function() {
    selectedExpression = null;
    matches = {};
    correctCount = 0;
    wrongAttempts = 0;
    clippyHintIndex = 0;
    clippyDismissed = false;
    document.getElementById('clippyContainer').style.display = 'flex';
    document.getElementById('statusText').textContent = 'Select an expression, then click its matching phrase.';
    document.getElementById('hintPanel').classList.remove('show');
    clippySpeak("üîÑ Fresh start! Let's match those quantifiers!<br>Click an expression on the left, then its description on the right.", true);
    render();
  };

  // ========== VICTORY ==========
  function victory() {
    document.getElementById('victoryOverlay').classList.add('show');
    launchConfetti();
    clippySpeak("üéÜ PERFECT! You matched ALL the quantifiers! ‚àÄproblems, ‚àÉsolutions! I'm so proud! ü•≤üìé");
    animateClippy('bounce');
  }

  function launchConfetti() {
    const emojis = ['üéâ', '‚ú®', 'üìé', 'üèÜ', 'üì¨', '‚úâÔ∏è', 'üéä', '‚àÄ', '‚àÉ', 'üìÆ'];
    for (let i = 0; i < 40; i++) {
      setTimeout(() => {
        const el = document.createElement('div');
        el.className = 'confetti';
        el.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        el.style.left = Math.random() * 100 + 'vw';
        el.style.fontSize = (14 + Math.random() * 20) + 'px';
        el.style.animationDuration = (2 + Math.random() * 3) + 's';
        document.body.appendChild(el);

        let y = -20;
        let x = parseFloat(el.style.left);
        let rot = 0;
        let speed = 2 + Math.random() * 3;
        let drift = (Math.random() - 0.5) * 2;
        let spin = (Math.random() - 0.5) * 10;

        const fall = () => {
          y += speed;
          rot += spin;
          el.style.top = y + 'px';
          el.style.transform = `rotate(${rot}deg) translateX(${Math.sin(y/50) * 20}px)`;
          if (y < window.innerHeight + 50) {
            requestAnimationFrame(fall);
          } else {
            el.remove();
          }
        };
        requestAnimationFrame(fall);
      }, i * 80);
    }
  }

  // ========== CLOCK ==========
  function updateClock() {
    const now = new Date();
    const h = now.getHours();
    const m = now.getMinutes().toString().padStart(2, '0');
    const ampm = h >= 12 ? 'PM' : 'AM';
    const h12 = h % 12 || 12;
    document.getElementById('taskbarClock').textContent = `${h12}:${m} ${ampm}`;
  }
  updateClock();
  setInterval(updateClock, 30000);

  // ========== EYE TRACKING ==========
  document.addEventListener('mousemove', (e) => {
    const lp = document.getElementById('leftPupil');
    const rp = document.getElementById('rightPupil');
    if (!lp || !rp) return;

    const clippy = document.getElementById('clippyChar');
    const rect = clippy.getBoundingClientRect();
    const cx = rect.left + rect.width / 2;
    const cy = rect.top + 40;

    const dx = e.clientX - cx;
    const dy = e.clientY - cy;
    const angle = Math.atan2(dy, dx);
    const dist = Math.min(2.5, Math.sqrt(dx*dx + dy*dy) / 100);

    const ox = Math.cos(angle) * dist;
    const oy = Math.sin(angle) * dist;

    lp.setAttribute('cx', 50 + ox);
    lp.setAttribute('cy', 37 + oy);
    rp.setAttribute('cx', 70 + ox);
    rp.setAttribute('cy', 37 + oy);
  });

  // ========== INIT ==========
  render();

  // Clippy intro sequence
  setTimeout(() => {
    clippySpeak("üëã Hi! It looks like you're trying to match quantifier expressions with humorous descriptions of mathematical correspondence!<br><br>Would you like help?", false);
    document.getElementById('clippyText').innerHTML += `
      <div style="display:flex; gap:6px; flex-wrap:wrap; margin-top:8px;">
        <div class="clippy-bubble-btn" onclick="clippyRespond('yes')">Get a hint</div>
        <div class="clippy-bubble-btn" onclick="clippyRespond('no')">Go away!</div>
      </div>`;
  }, 800);

  // Periodic Clippy interruptions
  setInterval(() => {
    if (clippyDismissed || correctCount >= 6) return;
    const idle_msgs = [
      "Still working on those quantifiers? Remember, ‚àÄ means 'for all' and ‚àÉ means 'there exists'! üìñ",
      "Did you know? Pascal and Fermat's letters basically invented probability theory! All by snail mail! üêå",
      "Hey, you haven't clicked anything in a while. Need a hint? I have SEVERAL. üí°",
      "Fun thought: If ‚àÄclippy, annoying(clippy), then I'm just fulfilling my existential purpose! üòÑ",
      "I notice you're staring at the screen. That's a ‚àÉproblem : unsolved(problem) situation right there.",
      "Hint: The phrase about ink relates to someone writing to EVERYONE. That's a lot of quills! ü™∂",
    ];
    const msg = idle_msgs[Math.floor(Math.random() * idle_msgs.length)];
    clippySpeak(msg, true);
  }, 35000);
});
</script>
</body>
</html>
